### YamlMime:PowershellCmdlet
summary: |-
  This cmdlet allows you to set or update properties of a TeamsShiftPolicy instance, including Teams off shift warning message-specific settings.
module: MicrosoftTeamsPowerShell
notes: ""
inputs:
- name: <xref href="System.Management.Automation.PSObject" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="System.Object" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Get-CsTeamsShiftsPolicy
  href: Get-CsTeamsShiftsPolicy.yml
- text: New-CsTeamsShiftsPolicy
  href: New-CsTeamsShiftsPolicy.yml
- text: Remove-CsTeamsShiftsPolicy
  href: Remove-CsTeamsShiftsPolicy.yml
- text: Grant-CsTeamsShiftsPolicy
  href: Grant-CsTeamsShiftsPolicy.yml
syntaxes:
- Set-CsTeamsShiftsPolicy [[-Identity] <XdsIdentity>] [-ShiftNoticeFrequency <String>] [-ShiftNoticeMessageType <String>] [-ShiftNoticeMessageCustom <String>] [-AccessType <String>] [-AccessGracePeriodMinutes <Int64>] [-EnableScheduleOwnerPermissions <Boolean>] [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    PS C:\> Set-CsTeamsShiftsPolicy -Identity OffShiftAccess_WarningMessage1_AlwaysShowMessage -ShiftNoticeMessageType Message1 -ShiftNoticeFrequency always -AccessGracePeriodMinutes 5
  description: |-
    In this example, the policy instance is called "OffShiftAccess_WarningMessage1_AlwaysShowMessage", a warning message (Message 1) will always be displayed to the user on opening Teams during off shift hours.
  summary: ""
parameters:
- type: <xref href="Int64" data-throw-if-not-resolved="False" />
  name: AccessGracePeriodMinutes
  description: |+
    Indicates the grace period time in minutes between when the first shift starts, or last shift ends and when access is blocked.


  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AccessType
  description: |+
    Indicates the Teams access type granted to the user. Today, only unrestricted access to Teams app is supported.
    Use 'UnrestrictedAccess_TeamsApp' as the value for this setting, or is set by default.
    For Teams Off Shift Access Control, the option to show the user a blocking dialog message is supported. Once the user accepts this message, it is audit logged and the user has usual access to Teams. Set other off shift warning message-specific settings to configure off shift access controls for the user.


  defaultValue: UnrestrictedAccess_TeamsApp
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: EnableScheduleOwnerPermissions
  description: |+
    Indicates whether a user can manage a Shifts schedule as a team member.

  defaultValue: "False"
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="XdsIdentity" data-throw-if-not-resolved="False" />
  name: Identity
  description: |+
    Policy instance name.

  defaultValue: None
  position: "1"
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ShiftNoticeFrequency
  description: |+
    Frequency of warning dialog displayed when user opens Teams. Set one of Always, ShowOnceOnChange, Never.

  defaultValue: Always
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ShiftNoticeMessageCustom
  description: |+
    Provide a custom message. Must set ShiftNoticeMessageType to 'CustomMessage' to enforce this.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ShiftNoticeMessageType
  description: |+
    The warning message is shown in the blocking dialog when a user access Teams off shift hours. Select one of 7 Microsoft provided messages, a default message or a custom message. 
    'Message1' - Your employer does not authorize or approve of the use of its network, applications, systems, or tools by non-exempt or hourly employees during their non-working hours. By accepting, you acknowledge that your use of Teams while off shift is not authorized and you will not be compensated.
    'Message2' - Accessing this app outside working hours is voluntary. You won't be compensated for time spent on Teams. Refer to your employer's guidelines on using this app outside working hours. By accepting, you acknowledge that you understand the statement above.
    'Message3' - You won't be compensated for time using Teams. By accepting, you acknowledge that you understand the statement above.
    'Message4' - You're not authorized to use Teams while off shift. By accepting, you acknowledge your use of Teams is against your employer's policy.
    'Message5' - Access to Teams is turned off during non-working hours. You will be able to access the app when your next shift starts.
    'Message6' - Your employer does not authorize or approve of the use of its network, applications, systems, or tools by non-exempt or hourly employees during their non-working hours. Access to corporate resources are only allowed during approved working hours and should be recorded as hours worked in your employer's timekeeping system.
    'Message7' - Your employer has turned off access to Teams during non-working hours. Refer to your employer's guidelines on using this app outside working hours.
    'DefaultMessage' - You aren't authorized to use Microsoft Teams during non-working hours and will only be compensated for using it during approved working hours.
    'CustomMessage'


  defaultValue: DefaultMessage
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
uid: MicrosoftTeamsPowerShell.Set-CsTeamsShiftsPolicy
name: Set-CsTeamsShiftsPolicy
description: |-
  This cmdlet allows you to set or update properties of a TeamsShiftPolicy instance. Use this to set the policy name and Teams off shift warning message-specific settings (ShiftNoticeMessageType, ShiftNoticeMessageCustom, ShiftNoticeFrequency, AccessGracePeriodMinutes).
metadata:
  external help file: Microsoft.TeamsCmdlets.PowerShell.Custom.dll-Help.xml
  Module Name: MicrosoftTeams
  online version: https://learn.microsoft.com/powershell/module/teams/set-teamsshiftspolicy
  schema: 2.0.0
