### YamlMime:PowershellCmdlet
summary: |-
  This cmdlet creates a new workforce management (WFM) connection.
module: MicrosoftTeamsPowerShell
notes: ""
inputs:
- name: <xref href="Microsoft.Teams.ConfigAPI.Cmdlets.Generated.Models.IWfmConnectionRequest" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="Microsoft.Teams.ConfigAPI.Cmdlets.Generated.Models.IWfmConnectionResponse" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="Microsoft.Teams.ConfigAPI.Cmdlets.Generated.Models.IErrorDetailsResponse" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Get-CsTeamsShiftsConnection
  href: Get-CsTeamsShiftsConnection.yml
- text: Set-CsTeamsShiftsConnection
  href: Set-CsTeamsShiftsConnection.yml
- text: Update-CsTeamsShiftsConnection
  href: Update-CsTeamsShiftsConnection.yml
- text: Get-CsTeamsShiftsConnectionConnector
  href: Get-CsTeamsShiftsConnectionConnector.yml
- text: Test-CsTeamsShiftsConnectionValidate
  href: Test-CsTeamsShiftsConnectionValidate.yml
syntaxes:
- New-CsTeamsShiftsConnection -Body <IWfmConnectionRequest> [-Authorization <string>] [-Break] [-HttpPipelineAppend <SendAsyncStep[]>] [-HttpPipelinePrepend <SendAsyncStep[]>] [-Proxy <uri>] [-ProxyCredential <pscredential>] [-ProxyUseDefaultCredentials] [-WhatIf] [-Confirm] [<CommonParameters>]
- New-CsTeamsShiftsConnection -ConnectorId <string> -ConnectorSpecificSettings <IWfmConnectionRequestConnectorSpecificSettings> -Name <string> -State <string> [-Authorization <string>] [-Break] [-HttpPipelineAppend <SendAsyncStep[]>] [-HttpPipelinePrepend <SendAsyncStep[]>] [-Proxy <uri>] [-ProxyCredential <pscredential>] [-ProxyUseDefaultCredentials] [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    PS C:\> $result =  New-CsTeamsShiftsConnection `
       -connectorId "6A51B888-FF44-4FEA-82E1-839401E00000" `
       -name "Cmdlet test connection" `
       -connectorSpecificSettings (New-Object Microsoft.Teams.ConfigAPI.Cmdlets.Generated.Models.ConnectorSpecificBlueYonderSettingsRequest `
            -Property @{
                adminApiUrl = "https://contoso.com/retail/data/wfmadmin/api/v1-beta2"
                siteManagerUrl = "https://contoso.com/retail/data/wfmsm/api/v1-beta2"
                essApiUrl = "https://contoso.com/retail/data/wfmess/api/v1-beta1"
                retailWebApiUrl = "https://contoso.com/retail/data/retailwebapi/api/v1"
                cookieAuthUrl = "https://contoso.com/retail/data/login"
                federatedAuthUrl = "https://contoso.com/retail/data/login"
                LoginUserName = "PlaceholderForUsername"
                LoginPwd = "PlaceholderForPassword"
        }) `
        -state "Active"
    PS C:\> $result | Format-List

    {
    ConnectorId                              : 6A51B888-FF44-4FEA-82E1-839401E00000
    ConnectorSpecificSettingAdminApiUrl      : https://www.contoso.com/retail/data/wfmadmin/api/v1-beta2
    ConnectorSpecificSettingApiUrl           :
    ConnectorSpecificSettingAppKey           :
    ConnectorSpecificSettingClientId         :
    ConnectorSpecificSettingCookieAuthUrl    : https://www.contoso.com/retail/data/login
    ConnectorSpecificSettingEssApiUrl        : https://www.contoso.com/retail/data/wfmess/api/v1-beta2
    ConnectorSpecificSettingFederatedAuthUrl : https://www.contoso.com/retail/data/login
    ConnectorSpecificSettingRetailWebApiUrl  : https://www.contoso.com/retail/data/retailwebapi/api/v1
    ConnectorSpecificSettingSiteManagerUrl   : https://www.contoso.com/retail/data/wfmsm/api/v1-beta2
    ConnectorSpecificSettingSsoUrl           :
    CreatedDateTime                          : 24/03/2023 04:58:23
    Etag                                     : "5b00dd1b-0000-0400-0000-641d2df00000"
    Id                                       : 4dae9db0-0841-412c-8d6b-f5684bfebdd7
    LastModifiedDateTime                     : 24/03/2023 04:58:23
    Name                                     : Cmdlet test connection
    State                                    : Active
    TenantId                                 : 3FDCAAF2-863A-4520-97BA-DFA211595876
    }
  description: |-
    Returns the object of the created connection.

    In case of an error, we can capture the error response as follows:

    * Hold the cmdlet output in a variable: `$result=<CMDLET>`

    * To get the entire error message in Json: `$result.ToJsonString()`

    * To get the error object and object details: `$result, $result.Detail`
  summary: ""
- title: Example 2
  code: |-
    PS C:\> $result = New-CsTeamsShiftsConnection `
       -connectorId "95BF2848-2DDA-4425-B0EE-D62AEED4C0A0" `
       -name "Cmdlet test connection" `
       -connectorSpecificSettings (New-Object Microsoft.Teams.ConfigAPI.Cmdlets.Generated.Models.ConnectorSpecificUkgDimensionsSettingsRequest `
            -Property @{
                apiUrl = "https://www.contoso.com/api"
                ssoUrl = "https://www.contoso.com/sso"
                appKey = "PlaceholderForAppKey"
                clientId = "Es5Q2fB4PXweCyto6Ms6J2kRB7uwAc3W"
                clientSecret = "PlaceholderForClientSecret"
                LoginUserName = "PlaceholderForUsername"
                LoginPwd = "PlaceholderForPassword"
        }) `
        -state "Active"
    PS C:\> $result | Format-List

    ConnectorId                              : 95BF2848-2DDA-4425-B0EE-D62AEED4C0A0
    ConnectorSpecificSettingAdminApiUrl      :
    ConnectorSpecificSettingApiUrl           : https://www.contoso.com/api
    ConnectorSpecificSettingAppKey           :
    ConnectorSpecificSettingClientId         : Es5Q2fB4PXweCyto6Ms6J2kRB7uwAc3W
    ConnectorSpecificSettingCookieAuthUrl    :
    ConnectorSpecificSettingEssApiUrl        :
    ConnectorSpecificSettingFederatedAuthUrl :
    ConnectorSpecificSettingRetailWebApiUrl  :
    ConnectorSpecificSettingSiteManagerUrl   :
    ConnectorSpecificSettingSsoUrl           : https://www.contoso.com/sso
    CreatedDateTime                          : 06/04/2023 11:05:39
    Etag                                     : "3100fd6e-0000-0400-0000-642ea7840000"
    Id                                       : a2d1b091-5140-4dd2-987a-98a8b5338744
    LastModifiedDateTime                     : 06/04/2023 11:05:39
    Name                                     : Cmdlet test connection
    State                                    : Active
    TenantId                                 : 3FDCAAF2-863A-4520-97BA-DFA211595876
  description: ""
  summary: ""
parameters:
- type: <xref href="IConnectorInstanceRequest" data-throw-if-not-resolved="False" />
  name: Body
  isRequired: true
  description: |+
    The request body.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Break
  description: |+
    Wait for .NET debugger to attach.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: None
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ConnectorId
  isRequired: true
  description: |+
    The WFM connector ID.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Microsoft.Teams.ConfigAPI.Cmdlets.Generated.Models.ConnectorSpecificSettingsRequest" data-throw-if-not-resolved="False" />
  name: ConnectorSpecificSettings
  isRequired: true
  description: |+
    The connection name.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SendAsyncStep" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: HttpPipelineAppend
  description: |+
    SendAsync Pipeline Steps to be appended to the front of the pipeline

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SendAsyncStep" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: HttpPipelinePrepend
  description: |+
    SendAsync Pipeline Steps to be prepended to the front of the pipeline

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    The connection name.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Uri" data-throw-if-not-resolved="False" />
  name: Proxy
  description: |+
    The URI for the proxy server to use
  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="PSCredential" data-throw-if-not-resolved="False" />
  name: ProxyCredential
  description: |+
    Credentials for a proxy server to use for the remote call.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: ProxyUseDefaultCredentials
  description: |+
    Use the default credentials for the proxy.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: State
  isRequired: true
  description: |+
    The state of the connection. Valid values are "Active" and "Disabled". A third value, "ErrorDisabled", signifies an error in the connection.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: None
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: MicrosoftTeamsPowerShell.New-CsTeamsShiftsConnection
name: New-CsTeamsShiftsConnection
description: |-
  This cmdlet creates a Shifts WFM connection. It allows the admin to set up the environment for creating connection instances.
metadata:
  external help file: Microsoft.Teams.ConfigAPI.Cmdlets-help.xml
  Module Name: MicrosoftTeams
  title: New-CsTeamsShiftsConnection
  author: shane-malone
  ms.author: shanemalone
  manager: valk
  online version: https://learn.microsoft.com/powershell/module/teams/new-csteamsshiftsconnection
  schema: 2.0.0
