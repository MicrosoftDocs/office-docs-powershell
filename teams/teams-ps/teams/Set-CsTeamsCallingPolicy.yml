### YamlMime:PowershellCmdlet
summary: |-
  Use this cmdlet to update values in existing Teams Calling Policies.
module: MicrosoftTeamsPowerShell
notes: ""
inputs:
- name: <xref href="System.Management.Automation.PSObject" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="System.Object" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Get-CsTeamsCallingPolicy
  href: Get-CsTeamsCallingPolicy.yml
- text: Remove-CsTeamsCallingPolicy
  href: Remove-CsTeamsCallingPolicy.yml
- text: Grant-CsTeamsCallingPolicy
  href: Grant-CsTeamsCallingPolicy.yml
- text: New-CsTeamsCallingPolicy
  href: New-CsTeamsCallingPolicy.yml
syntaxes:
- >-
  Set-CsTeamsCallingPolicy [-Identity] <string> [-AllowPrivateCalling <boolean>] [-AllowWebPSTNCalling <boolean>]

   [-AllowSIPDevicesCalling <boolean>] [-AllowVoicemail <string>] [-AllowCallGroups <boolean>] [-AllowDelegation <boolean>]

   [-AllowCallForwardingToUser <boolean>] [-AllowCallForwardingToPhone <boolean>] [-PreventTollBypass <boolean>]

   [-BusyOnBusyEnabledType <string>] [-MusicOnHoldEnabledType <string>] [-AllowCloudRecordingForCalls <boolean>]

   [-AllowTranscriptionForCalling <boolean>] [-PopoutForIncomingPstnCalls <string>] [-PopoutAppPathForIncomingPstnCalls <string>]

   [-LiveCaptionsEnabledTypeForCalling <string>] [-AutoAnswerEnabledType <string>] [-SpamFilteringEnabledType <string>]

   [-CallRecordingExpirationDays <long>] [-AllowCallRedirect <string>]

   [-InboundPstnCallRoutingTreatment <string>] [-InboundFederatedCallRoutingTreatment <string>] [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    PS C:\> Set-CsTeamsCallingPolicy -Identity Global -AllowPrivateCalling $true
  description: |-
    Sets the value of the parameter AllowPrivateCalling in the Global (default) Teams Calling Policy instance.
  summary: ""
- title: Example 2
  code: |-
    PS C:\> Set-CsTeamsCallingPolicy -Identity HRPolicy -LiveCaptionsEnabledTypeForCalling Disabled
  description: |-
    Sets the value of the parameter LiveCaptionsEnabledTypeForCalling to Disabled in the Teams Calling Policy instance called HRPolicy.
  summary: ""
parameters:
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AllowCallForwardingToPhone
  description: |+
    Enables the user to configure in the Microsoft Teams client call forwarding or simultaneous ringing of inbound calls to any phone number.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AllowCallForwardingToUser
  description: |+
    Enables the user to configure in the Microsoft Teams client call forwarding or simultaneous ringing of inbound calls to other users in your tenant.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AllowCallGroups
  description: |+
    Enables the user to configure call groups in the Microsoft Teams client and that inbound calls should be routed to call groups.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AllowCallRedirect
  description: |+
    Setting this parameter enables local call redirection for SIP devices connecting via the Microsoft Teams SIP gateway.

    Valid options are:
    - Enabled: Enables the user to redirect an incoming call.
    - Disabled: The user is not enabled to redirect an incoming call.
    - UserOverride: This option is not available for use.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AllowCloudRecordingForCalls
  description: |+
    Determines whether cloud recording is allowed in a user's 1:1 Teams or PSTN calls. Set this to True to allow the user to be able to record 1:1 calls. Set this to False to prohibit the user from recording 1:1 calls.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AllowDelegation
  description: |+
    Enables the user to configure delegation in the Microsoft Teams client and that inbound calls to be routed to delegates; allows delegates to make outbound calls on behalf of the users for whom they have delegated permissions.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AllowPrivateCalling
  description: |+
    Controls all calling capabilities in Teams. Turning this off will turn off all calling functionality in Teams.
    If you use Skype for Business for calling, this policy will not affect calling functionality in Skype for Business.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AllowSIPDevicesCalling
  description: |+
    Determines whether the user is allowed to use a SIP device for calling on behalf of a Teams client.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: AllowTranscriptionForCalling
  description: |+
    Determines whether post-call transcriptions are allowed. Set this to True to allow. Set this to False to prohibit.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AllowVoicemail
  description: |+
    Enables inbound calls to be routed to voicemail. 

    Valid options are:
    - AlwaysEnabled: Calls are always forwarded to voicemail on unanswered after ringing for thirty seconds, regardless of the unanswered call forward setting for the user.
    - AlwaysDisabled: Calls are never routed to voicemail, regardless of the call forward or unanswered settings for the user. Voicemail isn't available as a call forwarding or unanswered setting in Teams.
    - UserOverride: Calls are forwarded to voicemail based on the call forwarding and/or unanswered settings for the user.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Object" data-throw-if-not-resolved="False" />
  name: AllowWebPSTNCalling
  description: |+
    Allows PSTN calling from the Teams web client.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: AutoAnswerEnabledType
  description: |+
    Setting this parameter allows you to enable or disable auto-answer for incoming meeting invites on Teams Phones. This setting applies only to incoming meeting invites and does not include support for other call types.

    Valid options are:
    - Enabled: Auto-answer is enabled.
    - Disabled: Auto-answer is disabled. This is the default setting.

  defaultValue: Disabled
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: BusyOnBusyEnabledType
  description: |+
    Setting this parameter lets you configure how incoming calls are handled when a user is already in a call or conference or has a call placed on hold.

    Valid options are:
    - Enabled: New or incoming calls will be rejected with a busy signal.
    - Unanswered: The user's unanswered settings will take effect, such as routing to voicemail or forwarding to another user.
    - Disabled: New or incoming calls will be presented to the user.
    - UserOverride: Users can set their busy options directly from call settings in Teams app.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Long" data-throw-if-not-resolved="False" />
  name: CallRecordingExpirationDays
  description: |+
    Sets the expiration of the recorded 1:1 calls. Default is 60 days.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Description
  description: |+
    Enables administrators to provide explanatory text about the calling policy. For example, the Description might indicate the users to whom the policy should be assigned.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Suppresses any confirmation prompts that would otherwise be displayed before making changes.

  defaultValue: "False"
  position: Named
  aliases: wi
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Identity
  description: |+
    Name of the policy instance being created.

  defaultValue: None
  position: "1"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: InboundFederatedCallRoutingTreatment
  description: |+
    Setting this parameter lets you control how inbound federated calls should be routed. 

    Valid options are:
    - RegularIncoming: No changes are made to default inbound routing. This is the default setting.
    - Unanswered: The inbound federated call will be routed according to the called user's unanswered call settings and the call will not be presented to the called user. The called user will see a missed call notification. If the called user has not enabled unanswered call settings the call will be disconnected.
    - Voicemail: The inbound federated call will be routed directly to the called user's voicemail and the call will not be presented to the user. If the called user does not have voicemail enabled the call will be disconnected.

    Setting this parameter to Unanswered or Voicemail will have precedence over other call forwarding settings like call forward/simultaneous ringing to delegate, call groups, or call forwarding.

  defaultValue: RegularIncoming
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: InboundPstnCallRoutingTreatment
  description: |+
    Setting this parameter lets you control how inbound PSTN calls should be routed. 

    Valid options are:
    - RegularIncoming: No changes are made to default inbound routing. This is the default setting.
    - Unanswered: The inbound PSTN call will be routed according to the called user's unanswered call settings and the call will not be presented to the called user. The called user will see a missed call notification. If the called user has not enabled unanswered call settings the call will be disconnected.
    - Voicemail: The inbound PSTN call will be routed directly to the called user's voicemail and the call will not be presented to the user. If the called user does not have voicemail enabled the call will be disconnected.
    - UserOverride: For now, setting the value to UserOverride is the same as RegularIncoming.

    Setting this parameter to Unanswered or Voicemail will have precedence over other call forwarding settings like call forward/simultaneous ringing to delegate, call groups, or call forwarding.

  defaultValue: RegularIncoming
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: LiveCaptionsEnabledTypeForCalling
  description: |+
    Determines whether real-time captions are available for the user in Teams calls.

    Valid options are:
    - DisabledUserOverride: Allows the user to turn on live captions.
    - Disabled: Prohibts the user from turning on live captions.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: MusicOnHoldEnabledType
  description: |+
    Setting this parameter allows you to turn on or turn off the music on hold when a caller is placed on hold. 

    Valid options are:
    - Enabled: Music on hold is enabled. This is the default.
    - Disabled: Music on hold is disabled.
    - UserOverride: For now, setting the value to UserOverride is the same as Enabled.

  defaultValue: Enabled
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: PopoutAppPathForIncomingPstnCalls
  description: |+
    Setting this parameter allows you to set the PopoutForIncomingPstnCalls setting's URL path of the website to launch upon receiving incoming PSTN calls. This parameter accepts an HTTPS URL with less than 1024 characters. The URL can contain a `{phone}` placeholder that is replaced with the caller's PSTN number in E.164 format when launched.

  defaultValue: '""'
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: PopoutForIncomingPstnCalls
  description: |+
    Setting this parameter allows you to control the tenant users' ability to launch an external website URL automatically in the browser window upon incoming PSTN calls for specific users or user groups. Valid options are Enabled and Disabled.

  defaultValue: Disabled
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: PreventTollBypass
  description: |+
    Setting this parameter to True will send calls through PSTN and incur charges rather than going through the network and bypassing the tolls. 

    **Note**: Do not set this parameter to True for Calling Plan or Operator Connect users as it will prevent successful call routing. This setting only works with Direct Routing which is configured to handle location-based routing restrictions. 

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: SpamFilteringEnabledType
  description: |+
    Determines if spam detection is enabled for inbound PSTN calls.

    Possible values:
    - Enabled: Spam detection is enabled. In case the inbound call is considered spam, the user will get a "Spam Likely" label in Teams.
    - Disabled: Spam detection is disabled.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
applicable:
- Microsoft Teams
uid: MicrosoftTeamsPowerShell.Set-CsTeamsCallingPolicy
name: Set-CsTeamsCallingPolicy
description: |-
  The Teams Calling Policy controls which calling and call forwarding features are available to users in Microsoft Teams. This cmdlet allows admins to set values in
  a given Calling Policy instance.

  Only the parameters specified are changed. Other parameters keep their existing values.
metadata:
  external help file: Microsoft.Rtc.Management.Hosted.dll-help.xml
  Module Name: MicrosoftTeams
  online version: https://learn.microsoft.com/powershell/module/teams/set-csteamscallingpolicy
  applicable: Microsoft Teams
  title: Set-CsTeamsCallingPolicy
  schema: 2.0.0
  manager: bulenteg
  author: jenstrier
  ms.author: serdars
  ms.reviewer: ""
