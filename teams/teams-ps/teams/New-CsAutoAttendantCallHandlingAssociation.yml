### YamlMime:PowershellCmdlet
summary: |-
  Use the `New-CsAutoAttendantCallHandlingAssociation` cmdlet to create a new call handling association.
module: MicrosoftTeamsPowerShell
notes: ""
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="Microsoft.Rtc.Management.OAA.Models.CallHandlingAssociation" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: New-CsAutoAttendantCallFlow
  href: New-CsAutoAttendantCallFlow.yml
- text: New-CsOnlineSchedule
  href: New-CsOnlineSchedule.yml
- text: Get-CsOnlineSchedule
  href: Get-CsOnlineSchedule.yml
syntaxes:
- New-CsAutoAttendantCallHandlingAssociation -CallFlowId <String> -ScheduleId <String> -Type <AfterHours | Holiday> [-Disable] [-Tenant <Guid>] [<CommonParameters>]
examples:
- title: '-------------------------- Example 1 --------------------------'
  code: |-
    $tr = New-CsOnlineTimeRange -Start 09:00 -End 17:00
    $schedule = New-CsOnlineSchedule -Name "Business Hours" -WeeklyRecurrentSchedule -MondayHours @($tr) -TuesdayHours @($tr) -WednesdayHours @($tr) -ThursdayHours @($tr) -FridayHours @($tr) -Complement
    $scheduleId = $schedule.Id

    $menuPrompt = New-CsAutoAttendantPrompt -TextToSpeechPrompt "To reach your party by name, enter it now, followed by the pound sign."
    $menu = New-CsAutoAttendantMenu -Name "Default Menu" -Prompts $menuPrompt -EnableDialByName
    $callFlow = New-CsAutoAttendantCallFlow -Name "Default Call Flow" -Menu $menu
    $callFlowId = $callFlow.Id

    $callHandlingAssociation = New-CsAutoAttendantCallHandlingAssociation -Type AfterHours -ScheduleId $scheduleId -CallFlowId $callFlowId
  description: |-
    This example creates the following:

    - a new after-hours schedule
    - a new after-hours call flow
    - a new after-hours call handling association
  summary: ""
- title: '-------------------------- Example 2 --------------------------'
  code: |-
    $tr = New-CsOnlineTimeRange -Start 09:00 -End 17:00
    $schedule = New-CsOnlineSchedule -Name "Business Hours" -WeeklyRecurrentSchedule -MondayHours @($tr) -TuesdayHours @($tr) -WednesdayHours @($tr) -ThursdayHours @($tr) -FridayHours @($tr) -Complement
    $scheduleId = $schedule.Id

    $menuPrompt = New-CsAutoAttendantPrompt -TextToSpeechPrompt "To reach your party by name, enter it now, followed by the pound sign."
    $menu = New-CsAutoAttendantMenu -Name "Default Menu" -Prompts $menuPrompt -EnableDialByName
    $callFlow = New-CsAutoAttendantCallFlow -Name "Default Call Flow" -Menu $menu
    $callFlowId = $callFlow.Id

    $disabledCallHandlingAssociation = New-CsAutoAttendantCallHandlingAssociation -Type AfterHours -ScheduleId $scheduleId -CallFlowId $callFlowId -Disable
  description: |-
    This example creates the following:

    - a new after-hours schedule
    - a new after-hours call flow
    - a disabled after-hours call handling association
  summary: ""
- title: '-------------------------- Example 3 --------------------------'
  code: |-
    $dtr = New-CsOnlineDateTimeRange -Start "24/12/2017"
    $schedule = New-CsOnlineSchedule -Name "Christmas" -FixedSchedule -DateTimeRanges @($dtr)
    $scheduleId = $schedule.Id

    $menuPrompt = New-CsAutoAttendantPrompt -TextToSpeechPrompt "We are closed for Christmas. Please call back later."
    $menuOption = New-CsAutoAttendantMenuOption -DtmfResponse Automatic -Action DisconnectCall
    $menu = New-CsAutoAttendantMenu -Name "Christmas Menu" -Prompts @($menuPrompt) -MenuOptions @($menuOption)
    $callFlow = New-CsAutoAttendantCallFlow -Name "Christmas" -Greetings @($greeting) -Menu $menu
    $callFlowId = $callFlow.Id

    $callHandlingAssociation = New-CsAutoAttendantCallHandlingAssociation -Type Holiday -ScheduleId $scheduleId -CallFlowId $callFlowId
  description: |-
    This example creates the following:

    - a new holiday schedule
    - a new holiday call flow
    - a new holiday call handling association
  summary: ""
parameters:
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: CallFlowId
  isRequired: true
  description: |+
    The CallFlowId parameter represents the call flow to be associated with the schedule.

    You can create a call flow by using the [`New-CsAutoAttendantCallFlow`](New-CsAutoAttendantCallFlow.yml) cmdlet.


  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Disable
  description: |+
    The Disable parameter, if set, establishes that the call handling association is created as disabled. This parameter can only be used when the Type parameter is set to AfterHours.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: ScheduleId
  isRequired: true
  description: |+
    The ScheduleId parameter represents the schedule to be associated with the call flow.

    You can create a schedule by using the [`New-CsOnlineSchedule`](New-CsOnlineSchedule.yml) cmdlet. Additionally, you can use [`Get-CsOnlineSchedule`](Get-CsOnlineSchedule.yml) cmdlet to get the schedules configured for your organization.


  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Guid" data-throw-if-not-resolved="False" />
  name: Tenant
  description: |+
    Globally unique identifier (GUID) of the tenant account whose external user communication policy are being created. For example:

    -Tenant "38aad667-af54-4397-aaa7-e94c79ec2308"

    You can return your tenant ID by running this command:

    Get-CsTenant | Select-Object DisplayName, TenantID

    If you are using a remote session of Windows PowerShell and are connected only to Skype for Business Online you do not have to include the Tenant parameter. Instead, the tenant ID will automatically be filled in for you based on your connection information. The Tenant parameter is primarily for use in a hybrid deployment.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
- type: <xref href="Object" data-throw-if-not-resolved="False" />
  name: Type
  isRequired: true
  description: |+
    The Type parameter represents the type of the call handling association. Currently, only the following types are supported:

    - `AfterHours`
    - `Holiday`


  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Microsoft Teams
  parameterValueGroup: ""
applicable:
- Microsoft Teams
uid: MicrosoftTeamsPowerShell.New-CsAutoAttendantCallHandlingAssociation
name: New-CsAutoAttendantCallHandlingAssociation
description: |-
  The `New-CsAutoAttendantCallHandlingAssociation` cmdlet creates a new call handling association to be used with the Auto Attendant (AA) service. The OAA service uses call handling associations to determine which call flow to execute when a specific schedule is in effect.
metadata:
  external help file: Microsoft.Rtc.Management.Hosted.dll-help.xml
  online version: https://learn.microsoft.com/powershell/module/teams/new-csautoattendantcallhandlingassociation
  applicable: Microsoft Teams
  title: New-CsAutoAttendantCallHandlingAssociation
  schema: 2.0.0
  manager: bulenteg
  author: tomkau
  ms.author: tomkau
  ms.reviewer: williamlooney
