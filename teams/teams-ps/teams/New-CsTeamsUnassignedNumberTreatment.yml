### YamlMime:PowershellCmdlet
summary: |-
  Creates a new treatment for how calls to an unassigned number range should be routed. The call can be routed to a user, an application or to an announcement service where a custom message will be played to the caller.
module: MicrosoftTeamsPowerShell
notes: |-
  The cmdlet is available in Teams PS module 2.5.1 or later.

  The parameters Identity and TreatmentId are mutually exclusive.

  To route calls to unassigned Microsoft Calling Plan subscriber numbers, your tenant needs to have available Communications Credits.

  To route calls to unassigned Microsoft Calling Plan service numbers, your tenant needs to have at least one Microsoft Teams Phone Resource Account license.

  Both inbound calls to Microsoft Teams and outbound calls from Microsoft Teams will have the called number checked against the unassigned number range.

  If a specified pattern/range contains phone numbers that are assigned to a user or resource account in the tenant, calls to these phone numbers will be routed to 
  the appropriate target and not routed to the specified unassigned number treatment. There are no other checks of the numbers in the range. If the range contains
  a valid external phone number, outbound calls from Microsoft Teams to that phone number will be routed according to the treatment.
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="System.Object" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: Import-CsOnlineAudioFile
  href: Import-CsOnlineAudioFile.yml
- text: Get-CsTeamsUnassignedNumberTreatment
  href: Get-CsTeamsUnassignedNumberTreatment.yml
- text: Remove-CsTeamsUnassignedNumberTreatment
  href: Remove-CsTeamsUnassignedNumberTreatment.yml
- text: Set-CsTeamsUnassignedNumberTreatment
  href: Set-CsTeamsUnassignedNumberTreatment.yml
- text: Test-CsTeamsUnassignedNumberTreatment
  href: Test-CsTeamsUnassignedNumberTreatment.yml
syntaxes:
- >-
  New-CsTeamsUnassignedNumberTreatment [-Identity] <string> [-Description <string>] [-Pattern <string>] [-Target <string>]

   [-TargetType <string>] [-TreatmentPriority <int>]

   [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  New-CsTeamsUnassignedNumberTreatment -TreatmentId <string> [-Description <string>] [-Pattern <string>] [-Target <string>]

   [-TargetType <string>] [-TreatmentPriority <int>]

   [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    $RAObjectId = (Get-CsOnlineApplicationInstance -Identity aa@contoso.com).ObjectId
    New-CsTeamsUnassignedNumberTreatment -Identity MainAA -Pattern "^\+15552223333$" -TargetType ResourceAccount -Target $RAObjectId -TreatmentPriority 1
  description: |-
    This example creates a treatment that will route all calls to the number +1 (555) 222-3333 to the resource account aa@contoso.com.
    That resource account is associated with an Auto Attendant (not part of the example).
  summary: ""
- title: Example 2
  code: |-
    $Content = Get-Content "C:\Media\MainAnnoucement.wav" -Encoding byte -ReadCount 0
    $AudioFile = Import-CsOnlineAudioFile -FileName "MainAnnouncement.wav" -Content $Content
    $Fid=[System.Guid]::Parse($audioFile.Id)
    New-CsTeamsUnassignedNumberTreatment -Identity TR1 -Pattern "^\+1555333\d{4}$" -TargetType Announcement -Target $Fid.Guid -TreatmentPriority 2
  description: |-
    This example creates a treatment that will route all calls to unassigned numbers in the range +1 (555) 333-0000 to +1 (555) 333-9999 to the announcement service,
    where the audio file MainAnnouncement.wav will be played to the caller.
  summary: ""
- title: Example 3
  code: |-
    $UserObjectId = (Get-CsOnlineUser -Identity user@contoso.com).Identity
    New-CsTeamsUnassignedNumberTreatment -Identity TR2 -Pattern "^\+15552224444$" -TargetType User -Target $UserObjectId -TreatmentPriority 3
  description: |-
    This example creates a treatment that will route all calls to the number +1 (555) 222-4444 to the user user@contoso.com.
  summary: ""
parameters:
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Description
  description: |+
    Free format description of this treatment.

  defaultValue: None
  position: named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Identity
  isRequired: true
  description: |+
    The Id of the treatment.


  defaultValue: None
  position: named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Pattern
  isRequired: true
  description: |+
    A regular expression that the called number must match in order for the treatment to take effect. It is best pratice to start the regular expression with the hat character and end it with the dollar character.
    You can use various regular expression test sites on the Internet to validate the expression.

  defaultValue: None
  position: named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Guid" data-throw-if-not-resolved="False" />
  name: Target
  isRequired: true
  description: |+
    The identity of the destination the call should be routed to. Depending on the TargetType it should either be the ObjectId of the user or application instance/resource account or the AudioFileId of the uploaded audio file.

  defaultValue: None
  position: named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: TargetType
  isRequired: true
  description: |+
    The type of target used for the treatment. Allowed values are User, ResourceAccount and Announcement.

  defaultValue: None
  position: named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: TreatmentId
  isRequired: true
  description: |+
    The identity of the treatment.

  defaultValue: None
  position: named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Integer" data-throw-if-not-resolved="False" />
  name: TreatmentPriority
  isRequired: true
  description: |+
    The priority of the treatment. Used to distinguish identical patterns. The lower the priority the higher preference. The priority needs to be unique.

  defaultValue: None
  position: named
  aliases: ""
  parameterValueGroup: ""
applicable:
- Microsoft Teams
uid: MicrosoftTeamsPowerShell.New-CsTeamsUnassignedNumberTreatment
name: New-CsTeamsUnassignedNumberTreatment
description: |-
  This cmdlet creates a treatment for how calls to an unassigned number range should be routed.
metadata:
  external help file: Microsoft.Open.Teams.CommonLibrary.dll-Help.xml
  Module Name: MicrosoftTeams
  online version: https://learn.microsoft.com/powershell/module/teams/new-csteamsunassignednumbertreatment
  applicable: Microsoft Teams
  author: jenstrier
  ms.author: serdars
  ms.reviewer: ""
  manager: ""
  schema: 2.0.0
