### YamlMime:PowershellCmdlet
summary: |-
  This cmdlet is available only in Security & Compliance PowerShell. For more information, see [Security & Compliance PowerShell](https://learn.microsoft.com/powershell/exchange/scc-powershell).

  Use the Set-AppRetentionCompliancePolicy to modify app retention compliance policies.

  For information about the parameter sets in the Syntax section below, see [Exchange cmdlet syntax](https://learn.microsoft.com/powershell/exchange/exchange-cmdlet-syntax).
module: ExchangePowerShell
notes: ""
syntaxes:
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-AddExchangeLocation <MultiValuedProperty>]

   [-AddExchangeLocationException <MultiValuedProperty>]

   [-AddModernGroupLocation <MultiValuedProperty>]

   [-AddModernGroupLocationException <MultiValuedProperty>]

   [-Applications <String[]>]

   [-Comment <String>]

   [-Confirm]

   [-Enabled <Boolean>]

   [-Force]

   [-PolicyRBACScopes <MultiValuedProperty>]

   [-RemoveExchangeLocation <MultiValuedProperty>]

   [-RemoveExchangeLocationException <MultiValuedProperty>]

   [-RemoveModernGroupLocation <MultiValuedProperty>]

   [-RemoveModernGroupLocationException <MultiValuedProperty>]

   [-RestrictiveRetention <Boolean>]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-AddAdaptiveScopeLocation <MultiValuedProperty>]

   [-Applications <String[]>]

   [-Comment <String>]

   [-Confirm]

   [-Enabled <Boolean>]

   [-Force]

   [-RemoveAdaptiveScopeLocation <MultiValuedProperty>]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Comment <String>]

   [-Confirm]

   [-Enabled <Boolean>]

   [-Force]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Confirm]

   [-Force]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Confirm]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Confirm]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Confirm]

   [-RetryDistribution]

   [-WhatIf]

   [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    Set-AppRetentionCompliancePolicy -Identity "Regulation 563 Marketing" -Applications "User:MicrosoftTeams","Group:MicrosoftTeams,VivaEngage" -AddExchangeLocation "Scott Smith" -Comment "Added new counsel, 9/9/21"
  description: |-
    This example adds a new user to the existing static scope retention policy named Regulation 563 Marketing that's set up for Teams private channels messages.
  summary: ""
parameters:
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddAdaptiveScopeLocation
  description: |+
    The AddAdaptiveScopeLocation parameter specifies the adaptive scope location to add to the policy. You create adaptive scopes by using the New-AdaptiveScope cmdlet. You can use any value that uniquely identifies the adaptive scope. For example:

    - Name
    - Distinguished name (DN)
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddExchangeLocation
  description: |+
    The AddExchangeLocation parameter specifies the mailboxes to add to the list of included mailboxes when you aren't using the value All for the ExchangeLocation parameter. Valid values are:

    - A mailbox
    - A distribution group or mail-enabled security group (all mailboxes that are currently members of the group).

    To specify a mailbox or distribution group, you can use any value that uniquely identifies it. For example:

    - Name
    - Distinguished name (DN)
    - Email address
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddExchangeLocationException
  description: |+
    The AddExchangeLocationException parameter specifies the mailboxes to add to the list of excluded mailboxes when you're using the value All for the ExchangeLocation parameter. Valid values are:

    - A mailbox
    - A distribution group or mail-enabled security group

    To specify a mailbox or distribution group, you can use any value that uniquely identifies it. For example:

    - Name
    - Distinguished name (DN)
    - Email address
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddModernGroupLocation
  description: |+
    The AddModernGroupLocation parameter specifies the Microsoft 365 Groups to add to the list of included Microsoft 365 Groups when you aren't using the value All for the ModernGroupLocation parameter.

    You can use any value that uniquely identifies the Microsoft 365 Group. For example:

    - Name
    - Distinguished name (DN)
    - Email address
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddModernGroupLocationException
  description: |+
    The AddModernGroupLocationException parameter specifies the Microsoft 365 Groups to add to the list of excluded Microsoft 365 Groups when you're using the value All for the ModernGroupLocation parameter.

    You can use any value that uniquely identifies the Microsoft 365 Group. For example:

    - Name
    - Distinguished name (DN)
    - Email address
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Applications
  description: |+
    The Applications parameter specifies the applications to include and is relevant only for the following location parameters:

    - ExchangeLocation
    - ModernGroupLocation
    - AdaptiveScopeLocation

    This parameter uses the following syntax: `"LocationtType:App1,LocationType:App2,...LocationType:AppN` where LocationType is User or Group. For example, `"User:Exchange,User:OneDriveForBusiness,Group:Exchange,Group:SharePoint"` or `"User:MicrosoftTeams","User:VivaEngage"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Comment
  description: |+
    The Comment parameter specifies an optional comment. If you specify a value that contains spaces, enclose the value in quotation marks ("), for example: "This is an admin note".

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    The Confirm switch specifies whether to show or hide the confirmation prompt. How this switch affects the cmdlet depends on if the cmdlet requires confirmation before proceeding.

    - Destructive cmdlets (for example, Remove-\* cmdlets) have a built-in pause that forces you to acknowledge the command before proceeding. For these cmdlets, you can skip the confirmation prompt by using this exact syntax: `-Confirm:$false`.
    - Most other cmdlets (for example, New-\* and Set-\* cmdlets) don't have a built-in pause. For these cmdlets, specifying the Confirm switch without a value introduces a pause that forces you acknowledge the command before proceeding.

  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: Enabled
  description: |+
    The Enabled parameter enables or disables the policy. Valid values are:

    - $true: The policy is enabled. This is the default value.
    - $false: The policy is disabled.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    The Force switch hides warning or confirmation messages. You don't need to specify a value with this switch.

    You can use this switch to run tasks programmatically where prompting for administrative input is inappropriate.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="PolicyIdParameter" data-throw-if-not-resolved="False" />
  name: Identity
  isRequired: true
  description: |+
    The Identity parameter specifies the app retention compliance policy that you want to modify. You can use any value that uniquely identifies the policy. For example:

    - Name
    - Distinguished name (DN)
    - GUID

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: PolicyRBACScopes
  description: |+
    The PolicyRBACScopes parameter specifies the administrative units to assign to the policy. A valid value is the Microsoft Entra ObjectID (GUID value) of the administrative unit. You can specify multiple values separated by commas.

    Administrative units are available only in Microsoft Entra ID P1 or P2. You create and manage administrative units in Microsoft Graph PowerShell.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveAdaptiveScopeLocation
  description: |+
    The RemoveAdaptiveScopeLocation parameter specifies the adaptive scope location to remove from the policy. You create adaptive scopes by using the New-AdaptiveScope cmdlet. You can use any value that uniquely identifies the adaptive scope. For example:

    - Name
    - Distinguished name (DN)
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveExchangeLocation
  description: |+
    The RemoveExchangeLocation parameter specifies the mailboxes to remove from the list of included mailboxes when you aren't using the value All for the ExchangeLocation parameter. Valid values are:

    - A mailbox
    - A distribution group or mail-enabled security group

    To specify a mailbox or distribution group, you can use any value that uniquely identifies it. For example:

    - Name
    - Distinguished name (DN)
    - Email address
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveExchangeLocationException
  description: |+
    The RemoveExchangeLocationException parameter specifies the mailboxes to remove from the list of excluded mailboxes when you use the value All for the ExchangeLocation parameter. Valid values are:

    - A mailbox
    - A distribution group or mail-enabled security group

    To specify a mailbox or distribution group, you can use any value that uniquely identifies it. For example:

    - Name
    - Distinguished name (DN)
    - Email address
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveModernGroupLocation
  description: |+
    The RemoveModernGroupLocation parameter specifies the Microsoft 365 Groups to remove from the list of included groups when you aren't using the value All for the ModernGroupLocation parameter.

    You can use any value that uniquely identifies the Microsoft 365 Group. For example:

    - Name
    - Distinguished name (DN)
    - Email address
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveModernGroupLocationException
  description: |+
    The RemoveModernGroupLocationException parameter specifies the Microsoft 365 Groups to remove from the list of excluded groups when you're using the value All for the ModernGroupLocation parameter.

    You can use any value that uniquely identifies the Microsoft 365 Group. For example:

    - Name
    - Distinguished name (DN)
    - Email address
    - GUID

    You can enter multiple values separated by commas. If the values contain spaces or otherwise require quotation marks, use the following syntax: `"Value1","Value2",..."ValueN"`.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: RestrictiveRetention
  description: |+
    The RestrictiveRetention parameter specifies whether Preservation Lock is enabled for the policy. Valid values are:

    - $true: Preservation Lock is enabled for the policy. No one -- including an administrator -- can turn off the policy or make it less restrictive.
    - $false: Preservation Lock isn't enabled for the policy. This is the default value.

    After a policy has been locked, no one can turn off or disable it, or remove apps from the policy. The only ways that you can modify the policy are by adding apps to it, or extending its duration. A locked policy can be increased or extended, but it can't be reduced, disabled, or turned off.

    Therefore, before you lock a policy, it's critical that you understand your organization's compliance requirements, and that you don't lock a policy until you are certain that it's what you need.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: RetryDistribution
  isRequired: true
  description: |+
    The RetryDistribution switch specifies whether to redistribute the policy to all locations. You don't need to specify a value with this switch.

    Locations whose initial distributions succeeded aren't included in the retry. Policy distribution errors are reported when you use this switch.

    **Note**: Because the process of retrying distribution is a significant operation, run it only if necessary and for one policy at a time. It is not intended to be run every time you update a policy. If you run a script to update multiple policies, wait until the policy distribution is successful before running the command again for the next policy.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    The WhatIf switch doesn't work in Security & Compliance PowerShell.

  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Security & Compliance
  parameterValueGroup: ""
applicable:
- Security & Compliance
uid: ExchangePowerShell.Set-AppRetentionCompliancePolicy
name: Set-AppRetentionCompliancePolicy
description: |-
  To use this cmdlet in Security & Compliance PowerShell, you need to be assigned permissions. For more information, see [Permissions in the Microsoft Purview compliance portal](https://learn.microsoft.com/purview/microsoft-365-compliance-center-permissions).
metadata:
  external help file: Microsoft.Exchange.TransportMailflow-Help.xml
  online version: https://learn.microsoft.com/powershell/module/exchange/set-appretentioncompliancepolicy
  applicable: Security & Compliance
  title: Set-AppRetentionCompliancePolicy
  schema: 2.0.0
  author: chrisda
  ms.author: chrisda
  ms.reviewer: ""
