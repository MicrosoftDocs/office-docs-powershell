### YamlMime:PowershellCmdlet
summary: |-
  This cmdlet is available only in Exchange Server 2010.

  Use the Set-UMServer cmdlet to modify settings that are associated with the Unified Messaging (UM) server role.

  For information about the parameter sets in the Syntax section below, see [Exchange cmdlet syntax](https://learn.microsoft.com/powershell/exchange/exchange-cmdlet-syntax).
module: ExchangePowerShell
notes: ""
inputs:
- name: <xref href="Input types" data-throw-if-not-resolved="False" />
  description: |-
    To see the input types that this cmdlet accepts, see [Cmdlet Input and Output Types](https://go.microsoft.com/fwlink/p/?LinkId=2081749). If the Input Type field for a cmdlet is blank, the cmdlet doesn't accept input data.
outputs:
- name: <xref href="Output types" data-throw-if-not-resolved="False" />
  description: |-
    To see the return types, which are also known as output types, that this cmdlet accepts, see [Cmdlet Input and Output Types](https://go.microsoft.com/fwlink/p/?LinkId=2081749). If the Output Type field is blank, the cmdlet doesn't return data.
syntaxes:
- >-
  Set-UMServer [-Identity] <UMServerIdParameter>

   [-Confirm]

   [-DialPlans <MultiValuedProperty>]

   [-DomainController <Fqdn>]

   [-ExternalServiceFqdn <UMSmartHost>]

   [-GrammarGenerationSchedule <ScheduleInterval[]>]

   [-IrmLogEnabled <Boolean>]

   [-IrmLogMaxAge <EnhancedTimeSpan>]

   [-IrmLogMaxDirectorySize <Unlimited>]

   [-IrmLogMaxFileSize <ByteQuantifiedSize>]

   [-IrmLogPath <LocalLongFullPath>]

   [-MaxCallsAllowed <Int32>]

   [-SIPAccessService <ProtocolConnectionSettings>]

   [-SipTcpListeningPort <Int32>]

   [-SipTlsListeningPort <Int32>]

   [-Status <ServerStatus>]

   [-UMStartupMode <UMStartupMode>]

   [-WhatIf]

   [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    Set-UMServer -Identity MyUMServer -Status NoNewCalls
  description: |-
    This example prevents the Unified Messaging server MyUMServer from accepting new calls.
  summary: ""
- title: Example 2
  code: |-
    Set-UMServer -Identity MyUMServer -DialPlans $null
  description: |-
    This example removes the Unified Messaging server MyUMServer from all UM dial plans.
  summary: ""
- title: Example 3
  code: |-
    Set-UMServer -Identity MyUMServer -DialPlans MyUMDialPlanName -MaxCallsAllowed 50
  description: |-
    This example adds the Unified Messaging server MyUMServer to the UM dial plan MyUMDialPlanName and also sets the maximum number of incoming voice calls to 50.
  summary: ""
- title: Example 4
  code: |-
    Set-UMServer -Identity MyUMServer -GrammarGenerationSchedule 0.02:30-1.03:00,1.02:30-1.03:00,2.02:30-2.03:00,3.02:30-3.03:00,4.02:30-4.03:00,5.02:30-5.03:00,6.02:30-6.03:00
  description: |-
    This example changes the grammar generation schedule to 02:30-03:00 every day on the Unified Messaging server MyUMServer.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    The Confirm switch specifies whether to show or hide the confirmation prompt. How this switch affects the cmdlet depends on if the cmdlet requires confirmation before proceeding.

    - Destructive cmdlets (for example, Remove-\* cmdlets) have a built-in pause that forces you to acknowledge the command before proceeding. For these cmdlets, you can skip the confirmation prompt by using this exact syntax: `-Confirm:$false`.
    - Most other cmdlets (for example, New-\* and Set-\* cmdlets) don't have a built-in pause. For these cmdlets, specifying the Confirm switch without a value introduces a pause that forces you acknowledge the command before proceeding.

  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: DialPlans
  description: |+
    The DialPlans parameter specifies all the dial plans for which this server will handle UM calls. If no dial plans are defined, the Unified Messaging server won't handle UM calls.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="Fqdn" data-throw-if-not-resolved="False" />
  name: DomainController
  description: |+
    The DomainController parameter specifies the domain controller that's used by this cmdlet to read data from or write data to Active Directory. You identify the domain controller by its fully qualified domain name (FQDN). For example, dc01.contoso.com.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="UMSmartHost" data-throw-if-not-resolved="False" />
  name: ExternalServiceFqdn
  description: |+
    The ExternalServiceFqdn parameter is the FQDN or host name of a load balancer servicing Unified Messaging servers. This parameter is useful when you're migrating Unified Messaging servers from within your organization to a Microsoft Exchange Server 2010 hosted environment. The external service host FQDN can contain up to 2,048 characters.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="ScheduleInterval" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: GrammarGenerationSchedule
  description: |+
    The GrammarGenerationSchedule parameter specifies the scheduled times to start speech grammar generation. This parameter allows only one start time per day. The default scheduled time for grammar generation is 02:00-02:30 local time each day.

    The syntax for this parameter is: `StartDay.Hour:Minute [AM | PM]-EndDay.Hour:Minute [AM | PM]`. You can specify multiple schedules separated by commas: `"Schedule1","Schedule2",..."ScheduleN"`.

    You can use the following values for days:

    - Full name of the day.
    - Abbreviated name of the day.
    - Integer from 0 through 6, where 0 = Sunday.

    You can enter the time in 24 hour format and omit the AM/PM value. If you enter the time in 12 time hour format, include a space between the time and the AM/PM value.

    You can mix and match date/time formats.

    The start time and end time must be at least 15 minutes apart. Minutes are rounded down to 0, 15, 30, or 45. If you specify more than one interval, there must be at least 15 minutes between each interval.

    Here are some examples:

    - "Sun.11:30 PM-Mon.1:30 AM"
    - "6.22:00-6.22:15" (Run from Saturday at 10:00 PM until Saturday at 10:15 PM.)
    - "Sun.1:15 AM-Monday.23:00"
    - "Monday.4:30 AM-Monday.5:30 AM","Wednesday.4:30 AM-Wednesday.5:30 AM" (Run on Monday and Wednesday mornings from 4:30 until 5:30.)

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="UMServerIdParameter" data-throw-if-not-resolved="False" />
  name: Identity
  isRequired: true
  description: |+
    The Identity parameter specifies the Unified Messaging server that you want to modify. You can use any value that uniquely identifies the server. For example:

    - Name
    - GUID
    - Distinguished name (DN)
    - ExchangeLegacyDN

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: IrmLogEnabled
  description: |+
    The IrmLogEnabled parameter specifies whether to enable logging of Information Rights Management (IRM) transactions. IRM logging is enabled by default. Values include:

    - $true Enable IRM logging
    - $false Disable IRM logging

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="EnhancedTimeSpan" data-throw-if-not-resolved="False" />
  name: IrmLogMaxAge
  description: |+
    The IrmLogMaxAge parameter specifies the maximum age for the IRM log file. Log files that are older than the specified value are deleted. The default value is 30 days. To specify a value, enter the value as a time span: dd.hh:mm:ss, where d = days, h = hours, m = minutes, and s = seconds. The valid input range for this parameter is from 00:00:00 through 24855.03:14:07. Setting the value of the IrmLogMaxAge parameter to 00:00:00 prevents the automatic removal of IRM log files because of their age.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="Unlimited" data-throw-if-not-resolved="False" />
  name: IrmLogMaxDirectorySize
  description: |+
    The IrmLogMaxDirectorySize parameter specifies the maximum size of all IRM logs in the connectivity log directory. When a directory reaches its maximum file size, the server deletes the oldest log files first. The default value is 250 megabytes (MB). When you enter a value, qualify the value with one of the following units:

    - B (bytes)
    - KB (kilobytes)
    - MB (megabytes)
    - GB (gigabytes)
    - TB (terabytes)

    Unqualified values are treated as bytes. The value of the IrmLogMaxFileSize parameter must be less than or equal to the value of the IrmLogMaxDirectorySize parameter. The valid input range for either parameter is from 1 through 9223372036854775807 bytes. If you enter a value of unlimited, no size limit is imposed on the connectivity log directory.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="ByteQuantifiedSize" data-throw-if-not-resolved="False" />
  name: IrmLogMaxFileSize
  description: |+
    The IrmLogMaxFileSize parameter specifies the maximum size of each IRM log file. When a log file reaches its maximum file size, a new log file is created. The default value is 10 MB. When you enter a value, qualify the value with one of the following units:

    - B (bytes)
    - KB (kilobytes)
    - MB (megabytes)
    - GB (gigabytes)
    - TB (terabytes)

    Unqualified values are treated as bytes. The value of the IrmLogMaxFileSize parameter must be less than or equal to the value of the IrmLogMaxDirectorySize parameter. The valid input range for either parameter is from 1 through 9223372036854775807 bytes. If you enter a value of unlimited, no size limit is imposed on the IRM log files.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="LocalLongFullPath" data-throw-if-not-resolved="False" />
  name: IrmLogPath
  description: |+
    The IrmLogPath parameter specifies the default IRM log directory location. The default value is C:\\Program Files\\Microsoft\\Exchange Server\\V14. If you set the value of the IrmLogPath parameter to $null, you effectively disable IRM logging. However, if you set the value of the IrmLogPath parameter to $null when the value of the IrmLogEnabled attribute is $true, Exchange will log errors in the Application event log. The preferred way for disabling IRM logging is to set the IrmLogEnabled parameter to $false.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: MaxCallsAllowed
  description: |+
    The MaxCallsAllowed parameter specifies the maximum number of concurrent voice calls that the Unified Messaging server allows.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="ProtocolConnectionSettings" data-throw-if-not-resolved="False" />
  name: SIPAccessService
  description: |+
    The SIPAccessService parameter specifies the FQDN and TCP port of the nearest Lync Server Edge pool or Skype for Business Server Edge pool location for inbound and outbound calls from remote Lync or Skype for Business users located outside of the network.

    We recommend that you always use this parameter in Lync Server or Skype for Business Server deployments that span multiple geographic regions; otherwise, the Unified Messaging server might select a pool for Real-Time Transport Protocol (RTP) media traffic that isn't the closest geographically to the remote user.

    You configure this parameter for each Unified Messaging server so the value identifies the closest Lync Server Edge pool or Skype for Business Server Edge pool to the Exchange server.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: SipTcpListeningPort
  description: |+
    The SipTcpListeningPort parameter specifies the TCP port used by the Unified Messaging server to receive incoming calls. This TCP port is used by Unified Messaging servers added to a UM dial plan that isn't configured to use SIP Secured or Secured mode. The default is port 5060.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: SipTlsListeningPort
  description: |+
    The SipTlsListeningPort parameter specifies the Transport Layer Security (TLS) port used by the Unified Messaging server to receive incoming calls. This TLS port is used by Unified Messaging servers that are added to a UM dial plan configured to use SIP Secured or Secured mode. The default is port 5061.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="ServerStatus" data-throw-if-not-resolved="False" />
  name: Status
  description: |+
    The Status parameter specifies the Unified Messaging server status. The available options are Enabled, Disabled, and NoNewCalls.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="UMStartupMode" data-throw-if-not-resolved="False" />
  name: UMStartupMode
  description: |+
    The UMStartupMode parameter specifies whether the Microsoft Exchange Unified Messaging service on a Unified Messaging server will start up in TCP, TLS, or Dual mode. If the Unified Messaging server is being added to UM dial plans that have different security settings, you should choose Dual mode. In Dual mode, the Unified Messaging server can listen on ports 5060 and 5061 at the same time. If the startup mode is changed, the Microsoft Exchange Unified Messaging service must be restarted.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    The WhatIf switch simulates the actions of the command. You can use this switch to view the changes that would occur without actually applying those changes. You don't need to specify a value with this switch.

  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Exchange Server 2010
  parameterValueGroup: ""
applicable:
- Exchange Server 2010
uid: ExchangePowerShell.Set-UmServer
name: Set-UmServer
description: |-
  The Set-UMServer cmdlet sets specific properties on a Unified Messaging server. This cmdlet can be used to set individual Unified Messaging parameters for a specified Unified Messaging server.

  After this task is completed, the cmdlet sets the parameters and the values specified.

  You need to be assigned permissions before you can run this cmdlet. Although this topic lists all parameters for the cmdlet, you may not have access to some parameters if they're not included in the permissions assigned to you. To find the permissions required to run any cmdlet or parameter in your organization, see [Find the permissions required to run any Exchange cmdlet](https://learn.microsoft.com/powershell/exchange/find-exchange-cmdlet-permissions).
metadata:
  external help file: Microsoft.Exchange.MediaAndDevices-Help.xml
  online version: https://learn.microsoft.com/powershell/module/exchange/set-umserver
  applicable: Exchange Server 2010
  title: Set-UmServer
  schema: 2.0.0
  author: chrisda
  ms.author: chrisda
  ms.reviewer: ""
