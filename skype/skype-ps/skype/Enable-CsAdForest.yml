### YamlMime:PowershellCmdlet
summary: |-
  Makes the Active Directory modifications required before you can install Skype for Business Server.
  This includes making global changes to the Configuration or System containers; creating universal groups; and creating property sets and display specifiers that are specific to Skype for Business Server.
  This cmdlet was introduced in Lync Server 2010.
module: SkypeForBusiness
notes: ""
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
syntaxes:
- >-
  Enable-CsAdForest [-GroupDomain <Fqdn>] [-GroupDomainController <Fqdn>] [-GlobalCatalog <Fqdn>]

   [-GlobalSettingsDomainController <Fqdn>] [-RootDomainController <Fqdn>] [-Force] [-Report <String>] [-WhatIf]

   [-Confirm] [-SkipPrepareCheck <Boolean>] [<CommonParameters>]
examples:
- title: '-------------------------- Example 1 --------------------------'
  code: |-
    Enable-CsAdForest
  description: |-
    This command prepares the Active Directory forest for the installation of Skype for Business Server.
    Because the GroupDomain parameter is not used, the universal security groups generated when you run the Enable-CsAdForest cmdlet will be created in the local domain.
  summary: ""
- title: '-------------------------- Example 2 --------------------------'
  code: |-
    Enable-CsAdForest -GroupDomain northamerica.litwareinc.com
  description: |-
    This command prepares the Active Directory forest for the installation of Skype for Business Server.
    The GroupDomain parameter is used to ensure that the universal security groups created by running the Enable-CsAdForest cmdlet will be created in the northamerica.litwareinc.com domain.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before executing the command.

  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Suppresses the display of any non-fatal error message that might occur when running the command.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Fqdn" data-throw-if-not-resolved="False" />
  name: GlobalCatalog
  description: |+
    FQDN of a global catalog server in your domain.
    This parameter is not required if you are running the Enable-CsAdForest cmdlet on a computer with an account in your domain.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Fqdn" data-throw-if-not-resolved="False" />
  name: GlobalSettingsDomainController
  description: |+
    FQDN of a domain controller where global settings are stored.
    If global settings are stored in the System container in Active Directory, then this parameter must point to the root domain controller.
    If global settings are stored in the Configuration container, then any domain controller can be used and this parameter can be omitted.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Fqdn" data-throw-if-not-resolved="False" />
  name: GroupDomain
  description: |+
    Fully qualified domain name (FQDN) of the domain where the new universal security groups should be created.
    If this parameter is not included, then the groups will be created in the local domain.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Fqdn" data-throw-if-not-resolved="False" />
  name: GroupDomainController
  description: |+
    FQDN of a domain controller where universal group information is stored.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Report
  description: |+
    Enables you to specify a file path for the log file created when the cmdlet runs.
    For example: 

    `-Report "C:\Logs\ForestPrep.html"`

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Fqdn" data-throw-if-not-resolved="False" />
  name: RootDomainController
  description: |+
    FQDN of the root domain controller, used to create trust paths for clients that need to access resources in domains other than their own.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: SkipPrepareCheck
  description: |+
    When set to True ($True), causes Enable-CsAdForest to run without first doing its initial preparation checks.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Describes what would happen if you executed the command without actually executing the command.

  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
applicable:
- Lync Server 2010
- Lync Server 2013
- Skype for Business Server 2015
- Skype for Business Server 2019
uid: SkypeForBusiness.Enable-CsAdForest
name: Enable-CsAdForest
description: |-
  Before you can install Skype for Business Server, you must make a number of forest-level changes to Active Directory Domain Services.
  This includes creating display specifiers and objects specific to Skype for Business Server, creating the universal security groups that are needed to manage Skype for Business Server, and granting global settings object access rights to these groups.

  Forest preparation is typically carried out through the Skype for Business Server Setup Wizard.
  However, enterprise administrators can also perform forest preparation at any time by running the Enable-CsAdForest cmdlet.

  After the Enable-CsAdForest cmdlet finishes running, you can use the Get-CsAdForest cmdlet to verify that the forest is ready for the next step in the installation process.

  You must be an enterprise administrator in order to run the Enable-CsAdForest cmdlet locally.

  Historical Note: This cmdlet carries out tasks similar to those carried out by the following Microsoft Office Communications Server 2007 R2 command:

  `Lcscmd.exe /forest /action:ForestPrep`
metadata:
  external help file: Microsoft.Rtc.Management.dll-help.xml
  online version: https://learn.microsoft.com/powershell/module/skype/enable-csadforest
  applicable: Lync Server 2010, Lync Server 2013, Skype for Business Server 2015, Skype for Business Server 2019
  title: Enable-CsAdForest
  schema: 2.0.0
  manager: rogupta
  author: hirenshah1
  ms.author: hirshah
  ms.reviewer: ""
