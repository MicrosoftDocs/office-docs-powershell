### YamlMime:PowershellCmdlet
summary: |-
  Authorizes a new presence provider for use in the organization.
  Presence providers represent the PresenceProviders property of a collection of user services configuration settings.
  This cmdlet was introduced in Lync Server 2013.
module: SkypeForBusiness
notes: ""
inputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    None.
    The New-CsPresenceProvider cmdlet does not accept pipelined input.
outputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    The New-CsPresenceProvider cmdlet creates new instances of the Microsoft.Rtc.Management.WritableConfig.Settings.UserServices.PresenceProvider#Decorated object.
links:
- text: Get-CsPresenceProvider
  href: Get-CsPresenceProvider.yml
- text: Get-CsUserServicesConfiguration
  href: Get-CsUserServicesConfiguration.yml
- text: Remove-CsPresenceProvider
  href: Remove-CsPresenceProvider.yml
- text: Set-CsPresenceProvider
  href: Set-CsPresenceProvider.yml
syntaxes:
- >-
  New-CsPresenceProvider -Fqdn <String> -Parent <String> [-Confirm] [-Force] [-InMemory] [-WhatIf]

   [<CommonParameters>]
- New-CsPresenceProvider [-Identity] <XdsIdentity> [-Confirm] [-Force] [-InMemory] [-WhatIf] [<CommonParameters>]
examples:
- title: '-------------------------- Example 1 --------------------------'
  code: |-
    New-CsPresenceProvider -Parent "global" -Fqdn "fabrikam.com"
  description: |-
    The command shown in Example 1 creates a new presence provider (with the fully qualified domain name "fabrikam.com") that will be added to the global collection of user services configuration settings.
  summary: ""
- title: '-------------------------- Example 2 --------------------------'
  code: |-
    Get-CsUserServicesConfiguration | ForEach-Object {New-CsPresenceProvider -Parent $_.Identity -Fqdn "fabrikam.com"}
  description: |-
    Example 2 adds a presence provider with the Fqdn "fabrikam.com" to all the user services configuration collections in the organization.
    To do this, the command first uses the Get-CsUserServicesConfiguration cmdlet to return a collection of all the user services settings.
    Those settings are then piped to the ForEach-Object, which takes each item in the collection and a creates a new presence provider for that collection, using "fabrikam.com" as the presence provider Fqdn and the Identity of the user services collection as the presence provider Parent.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before executing the command.

  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Suppresses the display of any non-fatal error message that might occur when running the command.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Fqdn
  isRequired: true
  description: |+
    Fully qualified domain name for the presence provider.
    For example:

    -Fqdn "fabrikam.com"

    If you use the Fqdn parameter you must also use the Parent parameter.
    However, the Fqdn parameter cannot be used in the same command as the Identity parameter.

    Note that FQDNs must be unique at a given scope.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="XdsIdentity" data-throw-if-not-resolved="False" />
  name: Identity
  isRequired: true
  description: |+
    Unique identifier for the new presence provider.
    The Identity of a presence provider is composed of two parts: the scope (Parent) where the rule has been applied (for example, service:UserServer:atl-cs-001.litwareinc.com) and the provider's fully qualified domain name.
    To create a new provider at the global scope use syntax similar to this:

    `-Identity "global/fabrikam.com"`

    To create a provider at the site scope, use syntax like this:

    `-Identity "site:Redmond/fabrikam.com"`

    To create a provider at the service scope (for the UserServer service only), use syntax similar to this:

    `-Parent "UserServer:atl-cs-001.litwareinc.com"`

    You cannot use the Identity parameter in the same command as the Fqdn or the Parent parameter.

  defaultValue: None
  position: "2"
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: InMemory
  description: |+
    Creates an object reference without actually committing the object as a permanent change.
    If you assign the output of this cmdlet called with this parameter to a variable, you can make changes to the properties of the object reference and then commit those changes by calling this cmdlet's matching Set- cmdlet.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Parent
  isRequired: true
  description: |+
    Scope where the new presence provider will be created.
    To create a new presence provider at the global scope, use syntax similar to this:

    `-Parent "global"`

    To create a new provider at the site scope use syntax like this:

    `-Parent "site:Redmond"`

    To create a provider at the service scope (for the UserServer service only), use syntax similar to this:

    `-Parent "UserServer:atl-cs-001.litwareinc.com"`

    If you use the Parent parameter you must also include the Fqdn parameter.
    However, the Parent parameter cannot be used in conjunction with the Identity parameter.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Describes what would happen if you executed the command without actually executing the command.

  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
applicable:
- Lync Server 2013
- Skype for Business Server 2015
- Skype for Business Server 2019
uid: SkypeForBusiness.New-CsPresenceProvider
name: New-CsPresenceProvider
description: |-
  The CsPresenceProvider cmdlets are used to manage the PresenceProviders property found in the User Services configuration settings.
  Among other things, these settings are used to maintain presence information, including a collection of authorized presence providers.
  That collection is stored in the PresenceProviders property.
  You can use the New-CsPresenceProvider cmdlet to add an authorized presence provider to a collection of User Services configuration settings.

  Skype for Business Server Control Panel: The functions carried out by the New-CsPresenceProvider cmdlet are not available in the Skype for Business Server Control Panel.
metadata:
  external help file: Microsoft.Rtc.Management.dll-help.xml
  online version: https://learn.microsoft.com/powershell/module/skype/new-cspresenceprovider
  applicable: Lync Server 2013, Skype for Business Server 2015, Skype for Business Server 2019
  title: New-CsPresenceProvider
  schema: 2.0.0
  manager: rogupta
  author: hirenshah1
  ms.author: hirshah
  ms.reviewer: ""
