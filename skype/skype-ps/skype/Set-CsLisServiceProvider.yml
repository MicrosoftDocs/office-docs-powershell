### YamlMime:PowershellCmdlet
summary: |-
  Creates or modifies information about the web service provided by the Enhanced 9-1-1 (E9-1-1) Network Routing Provider to verify locations.
  This cmdlet was introduced in Lync Server 2010.
module: SkypeForBusiness
notes: ""
inputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    Accepts pipelined input of Location Information Server (LIS) service provider objects.
outputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    This cmdlet creates or modifies an object of type System.Management.Automation.PSCustomObject.
links:
- text: Remove-CsLisServiceProvider
  href: Remove-CsLisServiceProvider.yml
- text: Get-CsLisServiceProvider
  href: Get-CsLisServiceProvider.yml
syntaxes:
- >-
  Set-CsLisServiceProvider -CertFileName <String> -Password <SecureString> -ServiceProviderName <String>

   -ValidationServiceUrl <String> [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: '-------------------------- Example 1 --------------------------'
  code: |-
    $p = Read-Host -AsSecureString

    Set-CsLisServiceProvider -ServiceProviderName E911Provider -ValidationServiceUrl https://www.911contoso.com/validation/ -CertFileName C:\MS-Contoso-Cert.pfx -Password $p
  description: |-
    One of the required parameters for creating an entry for an E9-1-1 Network Routing Provider web service is a secure string containing the password to access the certificate file.
    Because of that, the first line in this example is a call to the Read-Host cmdlet.
    The Read-Host cmdlet will prompt for user input.
    We specify the parameter AsSecureString, which will display that input as asterisks (*) as it is entered.
    We've assigned the result of this command to the variable $p.
    The result will be a secure string, which is an encrypted version of the user input.
    In other words, running this command will prompt for the password to the web service and will store that password in the variable $p.

    Now that we have the password, we can create an object that will access the web service.
    We do this by calling the `Set-CsLisServiceProvider` cmdlet.
    We pass several parameters to this cmdlet.
    The first is the name of the provider, in this case E911Provider.
    Next we provide a value for the ValidationServiceUrl, https://www.911contoso.com/validation/.
    Note that this must be a "secure site," with the prefix https rather than http.
    Next we enter the name of the file containing the certificate used to access this web service, C:\MS-Contoso-Cert.pfx.
    Finally, we pass the variable $p (which contains the secure string with the web service password) to the Password parameter.
  summary: ""
parameters:
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: CertFileName
  isRequired: true
  description: |+
    The name (and full path) of the certificate file.
    This file must have a PFX file extension.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before executing the command.

  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SecureString" data-throw-if-not-resolved="False" />
  name: Password
  isRequired: true
  description: |+
    A secure string containing the password needed to access the certificate in the password protected file.
    Secure strings can be created by using the `ConvertTo-SecureString` cmdlet or the `Read-Host` cmdlet with the AsSecureString parameter.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ServiceProviderName
  isRequired: true
  description: |+
    The name of the E9-1-1 Network Routing Provider.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ValidationServiceUrl
  isRequired: true
  description: |+
    The URL of the web service.
    This must be a secure URL, beginning with the prefix https://.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Describes what would happen if you executed the command without actually executing the command.

  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
applicable:
- Lync Server 2010
- Lync Server 2013
- Skype for Business Server 2015
- Skype for Business Server 2019
uid: SkypeForBusiness.Set-CsLisServiceProvider
name: Set-CsLisServiceProvider
description: |-
  In an Enterprise Voice implementation with E9-1-1, emergency calls must first be routed through an E9-1-1 Network Routing Provider to ensure that the calls are routed to the appropriate Public Safety Answering Point (PSAP).
  (A PSAP is the agency in the United States that directs the calls to the nearest emergency services, such as police, fire and ambulance services.) In order to do this, the provider must have a list of locations from the organization that it can then match against the Master Street Address Guide to ensure all locations are valid.
  This cmdlet creates or modifies information about a provider, including the name of the provider, a URL for the web service that the organization will use to send the locations and a certificate and password for the secure web service.

  You cannot define more than one service provider for a given E9-1-1 implementation.
  This cmdlet will not succeed unless it can resolve the URL and security information for the web service.
metadata:
  external help file: Microsoft.Rtc.Management.dll-help.xml
  online version: https://learn.microsoft.com/powershell/module/skype/set-cslisserviceprovider
  applicable: Lync Server 2010, Lync Server 2013, Skype for Business Server 2015, Skype for Business Server 2019
  title: Set-CsLisServiceProvider
  schema: 2.0.0
  manager: rogupta
  author: hirenshah1
  ms.author: hirshah
  ms.reviewer: ""
