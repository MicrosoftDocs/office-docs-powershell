### YamlMime:PowershellCmdlet
summary: |-
  Creates a new Address Book normalization rule.
  Address Book normalization rules are used to convert phone numbers to a format readily understood by Skype for Business Server.
module: SkypeForBusiness
notes: ""
inputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    None.
    The New-CsAddressBookNormalizationRule cmdlet does not accept pipelined input.
outputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    The New-CsAddressBookNormalizationRule cmdlet creates instances of the Microsoft.Rtc.Management.WritableConfig.Settings.AddressBook.AddressBookNormalizationRule#Decorated object.
links:
- text: Get-CsAddressBookNormalizationRule
  href: Get-CsAddressBookNormalizationRule.yml
- text: Remove-CsAddressBookNormalizationRule
  href: Remove-CsAddressBookNormalizationRule.yml
- text: Set-CsAddressBookNormalizationRule
  href: Set-CsAddressBookNormalizationRule.yml
syntaxes:
- >-
  New-CsAddressBookNormalizationRule [-Identity] <XdsIdentity> [-Confirm] [-Description <String>] [-Force]

   [-InMemory] [-Pattern <String>] [-Priority <Int32>] [-Translation <String>] [-WhatIf] [<CommonParameters>]
- >-
  New-CsAddressBookNormalizationRule -Name <String> -Parent <String> [-Confirm] [-Description <String>] [-Force]

   [-InMemory] [-Pattern <String>] [-Priority <Int32>] [-Translation <String>] [-WhatIf] [<CommonParameters>]
examples:
- title: '-------------------------- Example 1 --------------------------'
  code: |-
    New-CsAddressBookNormalizationRule -Parent "site:Redmond" -Name RedmondFourDigit -Description "Dialing with internal four-digit extension" -Pattern '^(\d{4})$' -Translation '+1425555$1'
  description: |-
    The command shown in Example 1 creates a new Address book normalization rule named RedmondFourDigit; this rule will be included in the normalization rule collection assigned to the Redmond site.
    This new rule is designed to translate numbers that were dialed internally using just a 4-digit extension.
    In this example, the Pattern property is used to identify 4-digit numbers and the Translation property is used prepend the value +1425555 to each of these 4-digit numbers.
    For example, if the extension 1234 was dialed then this rule would translate the dialed number to +14255551234.

    Note the single quotes around the Pattern and Translation values.
    Single quotes are required for these values; double quotes (or no quotes) will cause the command to fail.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before executing the command.

  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Description
  description: |+
    Enables administrators to provide explanatory text that accompanies a normalization rule.
    For example, the Description might explain how the rule converts phone numbers.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Suppresses any confirmation prompts that would otherwise be displayed before making changes.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="XdsIdentity" data-throw-if-not-resolved="False" />
  name: Identity
  isRequired: true
  description: |+
    Unique identifier for the rule.
    The Identity specified must include the scope followed by a slash followed by the name; for example: site:Redmond/Rule1, where site:Redmond is the scope and Rule1 is the name.

    Note that the Identity is composed of the Parent (scope) and the Name.
    If you use the Identity parameter then you cannot use the Name or the Parent parameters.

  defaultValue: None
  position: "2"
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: InMemory
  description: |+
    Creates an object reference without actually committing the object as a permanent change.
    If you assign the output of this cmdlet called with this parameter to a variable, you can make changes to the properties of the object reference and then commit those changes by calling this cmdlet's matching Set-\<cmdlet\>.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    The name to be given to the new rule.
    This parameter is required if a value has been specified for the Parent parameter.
    If no value has been specified for the Parent parameter, the Name defaults to the name used in the Identity parameter.
    For example, if a rule is created with the Identity site:Redmond/RedmondRule, the Name will default to RedmondRule.
    The Name parameter and the Identity parameter cannot be used in the same command.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Parent
  isRequired: true
  description: |+
    The scope at which the new normalization rule will be created.
    Address book normalization rules can be created at the global scope, the site scope, or the service scope (for the Address Book service only).
    Note that a collection of Address Book normalization configuration settings must already be assigned to the specified scope before you can add a rule to that scope.
    For example, you cannot add a rule to the Redmond site unless you have already created Address Book normalization configuration settings for that site.

    The Parent parameter is required unless the Identity parameter is specified.
    You cannot include the Identity parameter and the Parent parameter in the same command.
    If you include the Parent parameter, the Name parameter is also required.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Pattern
  description: |+
    A regular expression that the phone number must match in order for this rule to be applied.

    The default value is ^(\d{11})$.
    This expression represents any set of numbers up to 11 digits.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Int32" data-throw-if-not-resolved="False" />
  name: Priority
  description: |+
    The order in which rules are applied; this is required because a given phone number might match more than one rule.
    The Priority parameter sets the order in which the rules are tested against the number.
    If a phone number matches multiple rules, the rule with the highest priority will be selected to do the conversion.

    Note that, when you set a priority, any existing rules will renumber themselves accordingly.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Translation
  description: |+
    The regular expression pattern that will be applied to the number to convert it to E.164 format.

    The default value is +$.
    This prefixes the number with a plus sign (+).

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Describes what would happen if you executed the command without actually executing the command.

  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
applicable:
- Skype for Business Server 2015
- Skype for Business Server 2019
uid: SkypeForBusiness.New-CsAddressBookNormalizationRule
name: New-CsAddressBookNormalizationRule
description: |-
  Normalization rules define the requirements for converting (or translating) numbers from an internal Skype for Business Server format to a standard (E.164) format.
  (Note that an understanding of regular expressions is helpful in order to understand what normalization rules do and how they do it.) The Address Book normalization rules handle these conversions and translations for Address Book servers.

  Although Address Book normalization rules are very similar to voice normalization rules, the two are not interchangeable: you cannot add voice normalization rules to an Address Book collection, nor can you add Address Book normalization rules to a dial plan.
  That means that, in some cases, you might need to create identical rules: one for assignment to Address Book servers, the other for assignment to dial plans.
metadata:
  external help file: Microsoft.Rtc.Management.dll-help.xml
  online version: https://learn.microsoft.com/powershell/module/skype/new-csaddressbooknormalizationrule
  applicable: Skype for Business Server 2015, Skype for Business Server 2019
  title: New-CsAddressBookNormalizationRule
  schema: 2.0.0
  manager: rogupta
  author: hirenshah1
  ms.author: hirshah
  ms.reviewer: ""
