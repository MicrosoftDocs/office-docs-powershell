### YamlMime:PowershellCmdlet
summary: |-
  Creates a new Response Group workflow.
  Workflows determine the actions that are taken when the Response Group application receives a phone call.
  This cmdlet was introduced in Lync Server 2010.
module: SkypeForBusiness
notes: ""
inputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    None.
    The New-CsRgsWorkflow cmdlet does not accept pipelined input.
outputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    The New-CsRgsWorkflow cmdlet creates new instances of the Microsoft.Rtc.Rgs.Management.WritableSettings.Workflow object.
links:
- text: Get-CsRgsWorkflow
  href: Get-CsRgsWorkflow.yml
- text: Remove-CsRgsWorkflow
  href: Remove-CsRgsWorkflow.yml
- text: Set-CsRgsWorkflow
  href: Set-CsRgsWorkflow.yml
syntaxes:
- >-
  New-CsRgsWorkflow [-Parent] <RgsIdentity> -Name <String> -PrimaryUri <Uri> [-Active <Boolean>]

   [-Anonymous <Boolean>] [-BusinessHoursID <RgsIdentity>] [-CustomMusicOnHoldFile <AudioFile>]

   [-DefaultAction <CallAction>] [-Description <String>] [-DisplayNumber <String>]

   [-EnabledForFederation <Boolean>] [-HolidayAction <CallAction>] [-Language <String>] [-LineUri <Uri>]

   [-NonBusinessHoursAction <CallAction>] [-TimeZone <String>] [-Force] [-InMemory] [-Confirm]

   [-HolidaySetIDList <System.Collections.ObjectModel.Collection`1[Microsoft.Rtc.Rgs.Management.RgsIdentity]>]

   [-WhatIf] [-Managed <Boolean>] [-ManagersByUri <System.Collections.ObjectModel.Collection`1[System.Uri]>]

   [<CommonParameters>]
examples:
- title: '-------------------------- EXAMPLE 1 --------------------------'
  code: |-
    New-CsRgsWorkflow -Parent service:ApplicationServer:atl-cs-001.litwareinc.com -Name "Help Desk" -PrimaryUri "sip:helpdesk@litwareinc.com"
  description: |-
    Example 1 creates a new workflow on the service ApplicationServer:atl-cs-001.litwareinc.com.
    This workflow is given the Name Help Desk and is assigned a primary URI of sip:helpdesk@litwareinc.com.
  summary: ""
- title: '-------------------------- EXAMPLE 2 --------------------------'
  code: |-
    $prompt = New-CsRgsPrompt -TextToSpeechPrompt "Welcome to the help desk."

    $queue = (Get-CsRgsQueue -Identity service:ApplicationServer:atl-cs-001.litwareinc.com -Name "Help Desk").Identity

    $callAction = New-CsRgsCallAction -Prompt $prompt -Action TransferToQueue -QueueId $queue

    New-CsRgsWorkflow -Parent service:ApplicationServer:atl-cs-001.litwareinc.com -Name "Help Desk" -PrimaryUri "sip:helpdesk@litwareinc.com" -DefaultAction $callAction
  description: |-
    The command shown in Example 2 create a new workflow prompt and call action, then assigns those items to a new Response Group workflow.
    In the first command, the New-CsRgsPrompt cmdlet is used to create a text-to-speech prompt "Welcome to the help desk." This new prompt is stored in a variable named $prompt.

    The second command uses the Get-CsRgsQueue cmdlet to retrieve the Identity of an existing Response Group queue named Help Desk; the returned Identity is stored in a variable named $queue.

    Command 3 then creates a new call action (stored in a variable named $callAction) that references both the new prompt ($prompt) and the retrieved queue ($queue).
    Finally, the last command in the example creates a new workflow named Help Desk.
    This command sets the PrimaryUri to sip:helpdesk@litwareinc.com and sets the value of the DefaultAction property to the call action created in the previous step.
  summary: ""
parameters:
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: Active
  description: |+
    If set to True, this means that the workflow is active and available to take phone calls.
    If set to False (the default value), the workflow is not available to take phone calls.

    When the Active property is set to True then the workflow will be validated before it is created.
    For example, the workflow will not be created if a DefaultAction has not been specified.
    If Active is set to False (or not configured) then no validation will take place, and the workflow will be created even if a DefaultAction has not been specified.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: Anonymous
  description: |+
    If set to True, the identities of individual Response Group agents will be masked any time these agents answer a call.
    If set to False (the default value), agent identities will be available to callers.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="RgsIdentity" data-throw-if-not-resolved="False" />
  name: BusinessHoursID
  description: |+
    Days of the week and times of the day that workflow agents are available to answer calls.
    The business hour Identities can be retrieved by using the Get-CsRgsHoursOfBusiness cmdlet.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before executing the command.



  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="AudioFile" data-throw-if-not-resolved="False" />
  name: CustomMusicOnHoldFile
  description: |+
    Represents custom music to be played when callers are placed on hold.
    (If not defined, callers will hear the default music when placed on hold.) Custom music must be imported by using the Import-CsRgsAudioFile cmdlet.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="CallAction" data-throw-if-not-resolved="False" />
  name: DefaultAction
  description: |+
    Indicates the action to be taken when a workflow is opened during business hours.
    DefaultAction must be defined by using the New-CsRgsCallAction cmdlet, and must either direct the call to a queue or to a question.
    The DefaultAction parameter is mandatory if the workflow is active, but can be omitted if the workflow is inactive.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Description
  description: |+
    Enables administrators to add additional information about a Response Group workflow.
    For example, the Description might include contact information for the owner of the workflow.
    This description appears in the Skype for Business contact card for the workflow.



  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DisplayNumber
  description: |+
    Phone number for the workflow as displayed in Skype for Business.
    The DisplayNumber can be formatted any way you want; for example:

    `-DisplayNumber "555-1219"`

    `-DisplayNumber "1-(425)-555-1219"`

    `-DisplayNumber "1.425.555.1219"`



  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: EnabledForFederation
  description: |+
    Indicates whether the workflow is available to users from a federated domain.
    If set to False, only users within your organization will have access to the workflow.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    Suppresses the display of any non-fatal error message that might occur when running the command.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="CallAction" data-throw-if-not-resolved="False" />
  name: HolidayAction
  description: |+
    Action to be taken if a call is received on a holiday.
    The HolidayAction must be defined by using the New-CsRgsCallAction cmdlet.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="System.Collections.ObjectModel.Collection`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="Microsoft.Rtc.Rgs.Management.RgsIdentity" data-throw-if-not-resolved="False" /><span>]</span>
  name: HolidaySetIDList
  description: |+
    Represents days when workflow agents are not available to answer calls.
    The holiday set Identities can be retrieved by using the Get-CsRgsHolidaySet cmdlet.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: InMemory
  description: |+
    Creates an object reference without actually committing the object as a permanent change.
    If you assign the output of this cmdlet called with this parameter to a variable, you can make changes to the properties of the object reference and then commit those changes by calling this cmdlet's matching Set-\<cmdlet\>.



  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Language
  description: |+
    Language that is used to read workflow text-to-speech prompts.
    The language parameter is optional as long as the operating system is using one of the supported languages shown in the list below.
    (Note that supported speech languages represent a subset of the languages that can be used on the operating system.)

    If the operating system is not using a supported language, then the Language parameter becomes mandatory, and the parameter must specify the language code for a supported language.
    If your operating system is using a non-supported language on the operating system, and you run the New-CsRgsWorkflow cmdlet without including the Language parameter, your command will fail.

    For example, suppose your operating system is running under the Faroese language.
    This language is supported by the Windows operating system, but not by the Response Group application.
    Therefore, you must include the Language parameter and a supported language when creating a new workflow.

    This is required because, if no language is specified, the workflow uses the operating system language.
    However, that language can be used in a workflow only if it is a language supported by the Response Group application.

    The language must be specified using one of the following language codes:

    ca-ES - Catalan (Spain)

    da-DK - Danish (Denmark)

    de-DE - German (Germany)

    en-AU - English (Australia)

    en-CA - English (Canada)

    en-GB - English (United Kingdom)

    en-IN - English (India)

    en-US - English (United States)

    es-ES - Spanish (Spain)

    es-MX - Spanish (Mexico)

    fi-FI - Finnish (Finland)

    fr-CA - French (Canada)

    fr-FR - French (France)

    it-IT - Italian (Italy)

    ja-JP - Japanese (Japan)

    ko-KR - Korean (Korea)

    nb-NO - Norwegian, Bokmal (Norway)

    nl-NL - Dutch (Netherlands)

    pl-PL - Polish (Poland)

    pt-BR - Portuguese (Brazil)

    pt-PT - Portuguese (Portugal)

    ru-RU - Russian (Russia)

    sv-SE - Swedish (Sweden)

    zh-CN - Chinese (People's Republic of China)

    zh-HK - Chinese (Hong Kong SAR)

    zh-TW - Chinese (Taiwan)

    For example: `-Language "nl-NL".`



  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Uri" data-throw-if-not-resolved="False" />
  name: LineUri
  description: |+
    Phone number for the workflow.
    The line Uniform Resource Identifier (URI) must be specified by using the following format: the TEL: prefix followed by a plus sign, followed by the country/region calling code, area code, and phone number (using only digits: no blank spaces, periods, or hyphens).
    For example: `-LineUri "TEL:+14255551219"`

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: Managed
  description: |+
    When set to True indicates that the workflow will be managed by one or more users.
    Those users can be specified by using the ManagedByUri parameter.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="System.Collections.ObjectModel.Collection`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.Uri" data-throw-if-not-resolved="False" /><span>]</span>
  name: ManagersByUri
  description: |+
    SIP addresses of the user (or users) who will manage the workflow.
    For example:

    `-ManagedByUri "sip:kenmyer@litwareinc.com"`

    To specify multiple managers separate the manager SIP addresses by using commas:

    `-ManagedByUri "sip:kenmyer@litwareinc.com", "sip:pilar@litwareinc.com"`

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Name
  isRequired: true
  description: |+
    Unique name to be assigned to the workflow.
    The combination of the Parent property and the Name property enables you to uniquely identify workflows without having to refer to the workflow's globally unique identifier (GUID).

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="CallAction" data-throw-if-not-resolved="False" />
  name: NonBusinessHoursAction
  description: |+
    Action to be taken if a call is received outside the workflow's business hours.
    The NonBusinessHoursAction must be defined by using the New-CsRgsCallAction cmdlet.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="RgsIdentity" data-throw-if-not-resolved="False" />
  name: Parent
  isRequired: true
  description: |+
    Service where the new workflow will be hosted.
    For example: `-Parent "service:ApplicationServer:atl-cs-001.litwareinc.com".`

  defaultValue: None
  position: "2"
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Uri" data-throw-if-not-resolved="False" />
  name: PrimaryUri
  isRequired: true
  description: |+
    SIP address for the workflow.
    For example: `-PrimaryUri "sip:helpdesk@litwareinc.com".`
    The PrimaryUri must begin with the "sip:" prefix.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: TimeZone
  description: |+
    Time zone information used when determining holidays and business hours.
    For example: `-TimeZone "Pacific Standard Time"`

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Describes what would happen if you executed the command without actually executing the command.



  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
applicable:
- Lync Server 2010
- Lync Server 2013
- Skype for Business Server 2015
- Skype for Business Server 2019
uid: SkypeForBusiness.New-CsRgsWorkflow
name: New-CsRgsWorkflow
description: |-
  Workflows are a key element in the Response Group application.
  Each workflow is uniquely associated with a phone number; when someone calls that number, the workflow determines how the call will be handled.
  For example, the call might be routed to a series of interactive voice response (IVR) questions that prompt the caller to enter additional information ("Press 1 for hardware support.
  Press 2 for software support.") Alternatively, the call might be placed in a queue and the caller placed on hold until an agent is available to answer the call.
  The availability of agents to answer calls is also dictated by the workflow: workflows are used to configure business hours (the days of the week and the times of day when agents are available to answer calls) and also holidays (days when no agents are available to answer calls).

  New workflows are created by using the New-CsRgsWorkflow cmdlet.
metadata:
  external help file: Microsoft.Rtc.Rgs.Management.dll-help.xml
  online version: https://learn.microsoft.com/powershell/module/skype/new-csrgsworkflow
  applicable: Lync Server 2010, Lync Server 2013, Skype for Business Server 2015, Skype for Business Server 2019
  title: New-CsRgsWorkflow
  schema: 2.0.0
  manager: rogupta
  author: hirenshah1
  ms.author: hirshah
  ms.reviewer: ""
