### YamlMime:PowershellCmdlet
summary: |-
  Exports data from a Persistent Chat database.
  This cmdlet was introduced in Lync Server 2013.
module: SkypeForBusiness
notes: ""
inputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    The Export-CsPersistentChatData cmdlet creates .ZIP files.
syntaxes:
- >-
  Export-CsPersistentChatData -DBInstance <String> [-AsBytes] [-DBName <String>] [-DisableExportedNodes]

   [-Level <ExportLevel>] [-Report <String>] [-Scope <System.Collections.Generic.List`1[System.String]>]

   [-StartDate <DateTime>] [<CommonParameters>]
- >-
  Export-CsPersistentChatData -DBInstance <String> [-DBName <String>] [-DisableExportedNodes]

   [-FileName <String>] [-Level <ExportLevel>] [-Report <String>]

   [-Scope <System.Collections.Generic.List`1[System.String]>] [-StartDate <DateTime>] [<CommonParameters>]
examples:
- title: '-------------------------- Example 1 --------------------------'
  code: |-
    Export-CsPersistentChatData -DBInstance "atl-sql-001.litwareinc.com\rtc" -FileName "C:\Logs\PersistentChatData.zip"
  description: |-
    The command shown in Example 1 exports Persistent Chat data from the Persistent Chat database located on the server atl-sql-001.litwareinc.com; the exported data will be stored in the file C:\Logs\PersistentChatData.zip.
    Because the Level parameter was not specified, the Export-CsPersistentChatData cmdlet will do a full export of the Persistent Chat information.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: AsBytes
  description: |+
    Returns Persistent Chat information as a byte array; the returned data must then be stored in a variable in order to be used by the Import-CsPersistentChatData cmdlet.
    You cannot use both AsBytes and FileName in the same command.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DBInstance
  isRequired: true
  description: |+
    Fully qualified domain name and name of the SQL Server instance where the Skype for Business Server 2015 Persistent Chat database is located.
    For example, this syntax specifies the database found in the RTC database instance on the server atl-sql-001.litwareinc.com:

    `-DBInstance "atl-sql-001.litwareinc.com\rtc"`

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: DBName
  description: |+
    SQL instance name of the Persistent Chat database.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: DisableExportedNodes
  description: |+
    When present, all exported categories and chat rooms will be disabled when the export is complete.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: FileName
  description: |+
    Full path to the .ZIP file that the Export-CsPersistentChatData cmdlet will create; this file will contain the exported user data.
    For example:

    `-FileName "C:\Logs\PersistentChatData.zip"`

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
- type: <xref href="ExportLevel" data-throw-if-not-resolved="False" />
  name: Level
  description: |+
    Enables you to specify which Persistent Chat information will be exported.
    Allowed values are:

    * All
    * User
    * Category
    * RoomDirectory
    * Content

    The default value is All, which means that all the Persistent Chat information will be exported.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Report
  description: |+
    Full path for the log file created when the cmdlet runs.
    For example:

    `-Report "C:\Logs\ExportPersistentChat.html"`

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
- type: <xref href="System.Collections.Generic.List`1" data-throw-if-not-resolved="False" /><span>[</span><xref href="System.String" data-throw-if-not-resolved="False" /><span>]</span>
  name: Scope
  description: |+
    Enables you to export data for a specified set of categories (and their corresponding chat rooms).
    By default all Categories are exported.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
- type: <xref href="DateTime" data-throw-if-not-resolved="False" />
  name: StartDate
  description: |+
    Beginning date for the time period for which Persistent Chat chat room content should be exported.
    For example:

    `-StartDate "1/1/2018"`

    This parameter is valid only when they Level is set to RoomDirectory.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2013
  - Skype for Business Server 2015
  parameterValueGroup: ""
applicable:
- Lync Server 2013
- Skype for Business Server 2015
uid: SkypeForBusiness.Export-CsPersistentChatData
name: Export-CsPersistentChatData
description: |-
  The Persistent Chat service (which replaces the Group Chat service used in Microsoft Lync Server 2010) provides organizations with messaging and collaboration capabilities similar to those found in Internet discussion forums: users can exchange messages in real-time, yet can also revisit and restart those conversations at any time.
  Conversations can be based around specific topics, and these conversations can be made available to everyone or to only a selected set of users.
  Likewise, individual chat rooms can be configured so that anyone can post a message or configured so that only designated presenters can post messages.

  If you are currently running Lync Server 2010, you can migrate your current Group Chat implementation by using the Export-CsPersistentChatData cmdlet to export your existing Group Chat configuration settings, then use the Import-CsPersistentChatData cmdlet to migrate that information to Skype for Business Server and the Persistent Chat service.
  Note that the Export-CsPersistentChatData cmdlet gives you the option of importing all your Group Chat settings and data or only a portion of your Group Chat settings and data; for example, you can export (and then import) your Group Chat categories and chat rooms without exporting all the content associated with those categories and chat rooms.

  Although primarily intended for migration purposes, the CsPersistentChatData cmdlets can also be used to manage Persistent Chat data on Skype for Business Server.

  To return a list of all the role-based access control (RBAC) roles this cmdlet has been assigned to (including any custom RBAC roles you have created yourself), run the following command from the Windows PowerShell prompt:

  `Get-CsAdminRole | Where-Object {$_.Cmdlets -match "Export-CsPersistentChatData"}`

  The functions carried out by the Export-CsPersistentChatData cmdlet are not available in the Skype for Business Server Control Panel.
metadata:
  external help file: Microsoft.Rtc.Management.dll-help.xml
  online version: https://learn.microsoft.com/powershell/module/skype/export-cspersistentchatdata
  applicable: Lync Server 2013, Skype for Business Server 2015
  title: Export-CsPersistentChatData
  schema: 2.0.0
  manager: rogupta
  author: hirenshah1
  ms.author: hirshah
  ms.reviewer: ""
