### YamlMime:PowershellCmdlet
summary: |-
  Assigns a hosted voice mail policy at the per-user scope.
  (The per-user scope enables you to assign policies to individual users or groups.) This cmdlet was introduced in Lync Server 2010.
module: SkypeForBusiness
notes: ""
inputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    String.
    Accepts a pipelined string value representing the Identity of a user account to which the hosted voice mail policy is being granted.
- name: <xref href="Microsoft.Rtc.Management.AD.UserIdParameter" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: |-
    When used with the PassThru parameter, returns an object of type Microsoft.Rtc.Management.ADConnect.Schema.OCSADUserOrAppContact.
- name: <xref href="System.Object" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: New-CsHostedVoicemailPolicy
  href: New-CsHostedVoicemailPolicy.yml
- text: Remove-CsHostedVoicemailPolicy
  href: Remove-CsHostedVoicemailPolicy.yml
- text: Set-CsHostedVoicemailPolicy
  href: Set-CsHostedVoicemailPolicy.yml
- text: Get-CsHostedVoicemailPolicy
  href: Get-CsHostedVoicemailPolicy.yml
- text: Get-CsUser
  href: Get-CsUser.yml
syntaxes:
- >-
  Grant-CsHostedVoicemailPolicy [-PolicyName] <String> [-Tenant <Guid>] [-DomainController <Fqdn>]

   [-Identity] <UserIdParameter> [-PassThru] [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: '-------------------------- EXAMPLE 1 --------------------------'
  code: |-
    Grant-CsHostedVoicemailPolicy -Identity "Ken Myer" -PolicyName ExRedmond
  description: |-
    This example assigns the hosted voice mail policy with the Identity ExRedmond to the user with the display name Ken Myer.
  summary: ""
- title: '-------------------------- EXAMPLE 2 --------------------------'
  code: |-
    Get-CsUser -OU "ou=Finance,ou=North America,dc=litwareinc,dc=com" | Grant-CsHostedVoicemailPolicy -PolicyName ExRedmond
  description: |-
    This example assigns the hosted voice mail policy with the Identity ExRedmond to all users in the Finance organizational unit (OU): OU=Finance,OU=NorthAmerica,DC=litwareinc,DC=com.
    The first part of the command calls the Get-CsUser cmdlet to retrieve all users who are enabled for Skype for Business Server from the specified OU.
    This collection of users is then piped to the Grant-CsHostedVoicemailPolicy cmdlet, which assigns the policy ExRedmond to each of these users.
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before executing the command.

  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="Fqdn" data-throw-if-not-resolved="False" />
  name: DomainController
  description: |+
    Allows you to specify a domain controller.
    If no domain controller is specified, the first available will be used.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="UserIdParameter" data-throw-if-not-resolved="False" />
  name: Identity
  isRequired: true
  description: |+
    The Identity (unique identifier) of the user to whom the hosted voice mail policy is being assigned.

    User identities can be specified using one of four formats: 1) The user's SIP address; 2) the user's user principal name (UPN); 3) the user's domain name and logon name, in the form domain\logon (for example, litwareinc\kenmyer); and, 4) the user's Active Directory display name (for example, Ken Myer).

    Note that you can use the asterisk (*) wildcard character when using the Display Name as the user Identity.
    For example, the Identity "* Smith" would return all the users with the last name Smith.

    Full data type: Microsoft.Rtc.Management.AD.UserIdParameter

  defaultValue: None
  pipelineInput: true
  position: "1"
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: PassThru
  description: |+
    Returns the results of the command.
    By default, this cmdlet does not generate any output.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: PolicyName
  description: |+
    The name (Identity) of the hosted voice mail policy to be assigned to the user.
    (Note that this includes only the name portion of the Identity.
    Per-user hosted voice mail policy identities include a prefix of tag: that should not be included with the PolicyName.)

  defaultValue: None
  position: "2"
  aliases: ""
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Describes what would happen if you executed the command without actually executing the command.

  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Lync Server 2010
  - Lync Server 2013
  - Skype for Business Server 2015
  - Skype for Business Server 2019
  parameterValueGroup: ""
applicable:
- Lync Server 2010
- Lync Server 2013
- Skype for Business Server 2015
- Skype for Business Server 2019
uid: SkypeForBusiness.Grant-CsHostedVoicemailPolicy
name: Grant-CsHostedVoicemailPolicy
description: |-
  This cmdlet assigns an existing user-specific hosted voice mail policy to a user.
  A hosted voice mail policy specifies how to route unanswered calls to a user to a hosted Exchange Unified Messaging (UM) service.

  You can check whether a user has been granted a per-user hosted voice mail policy by calling a command in this format: `Get-CsUser "\<user name\>" | Select-Object HostedVoicemailPolicy.`
  For example:

  `Get-CsUser "Ken Myer" | Select-Object HostedVoicemailPolicy`

  If you assign to a user a hosted voice mail policy that does not include a destination, you cannot enable that user for hosted voice mail.
metadata:
  external help file: Microsoft.Rtc.Management.dll-help.xml
  online version: https://learn.microsoft.com/powershell/module/skype/grant-cshostedvoicemailpolicy
  applicable: Lync Server 2010, Lync Server 2013, Skype for Business Server 2015, Skype for Business Server 2019
  title: Grant-CsHostedVoicemailPolicy
  schema: 2.0.0
  manager: bulenteg
  author: tomkau
  ms.author: tomkau
  ms.reviewer: rogupta
